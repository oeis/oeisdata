%I A390207 #34 Dec 10 2025 16:26:52
%S A390207 1,1,1,1,2,2,1,1,2,5,3,2,3,4,7,1,3,3,6,8,6,14,3,2,12,9,3,7,12,11,1,1,
%T A390207 19,6,19,3,9,13,18,12,10,10,26,23,18,50,3,2,9,32,10,22,5,4,54,11,28,
%U A390207 30,16,16,17,24,14,1,76,47,7,11,58,64,4,3,12,20,62,33,54,29,13
%N A390207 Let T_n be a rooted tree constructed in the following way. With k_0 = n as the root, let k_i be a vertex of depth i. For each prime divisor p of k_i, the children of k_i are those m = k_i + (-1)^i*k_i/p, where m >= 1 and m does not appear in the path from k_0 to k_i. a(n) is the number of paths in T_n.
%C A390207 This sequence is similar to A333123.
%C A390207 T_n is finite for n > 0, and therefore a(n) is a positive integer for every n. See the Englezou link for a proof.
%C A390207 When carrying out the operation defined in the name on other subsets of divisors the corresponding trees are not necessarily finite. For example, when adding and subtracting prime divisors, T_93 is the first possibly infinite tree. When adding and subtracting proper divisors greater than 1, T_10 is the first possibly infinite tree. And when adding and subtracting proper divisors including 1, T_8 is the first possibly infinite tree.
%H A390207 Miles Englezou, <a href="/A390207/b390207.txt">Table of n, a(n) for n = 1..3101</a>
%H A390207 Miles Englezou, <a href="/A390207/a390207_2.txt">Proof</a>
%F A390207 a(n) = 1 if and only if n is a power of two or a Mersenne prime.
%e A390207 a(2) = 1 since there is only one path {2, 3}.
%e A390207 a(5) = 2 since there are two paths {5, 6, 3, 4, 2} and {5, 6, 4}.
%e A390207 a(10) = 5 since there are five paths {10, 12, 6, 8, 4}, {10, 12, 6, 9}, {10, 12, 8}, {10, 15, 12, 16, 8}, and {10, 15, 12, 6, 9}.
%e A390207 The tree T_10 looks like this:
%e A390207           10
%e A390207         /    \
%e A390207       12      15
%e A390207      /  \     |
%e A390207     6    8    12
%e A390207    / \       /  \
%e A390207   8   9     16  18
%e A390207   |         |   |
%e A390207   4         8   9
%o A390207 (PARI)
%o A390207 a(n)=
%o A390207 {
%o A390207     if(n == 1, return(1));
%o A390207     my(count = 0);
%o A390207     my(S = [[n, 0, [n]]]);
%o A390207     while(#S,
%o A390207         my(t = S[#S]);
%o A390207         S = S[1..#S-1];
%o A390207         my(r = t[1], m = t[2], path = t[3]);
%o A390207         my(P = factor(r)[,1]);
%o A390207         my(has_child = 0);
%o A390207         for(i = 1, #P,
%o A390207             my(d = r/P[i]);
%o A390207             my(s = r + (-1)^m * d);
%o A390207             if( !setsearch(path, s),
%o A390207                 has_child = 1;
%o A390207                 my(newpath = setunion(path, [s]));
%o A390207                 S = concat(S, [[s, m+1, newpath]]);
%o A390207             );
%o A390207         );
%o A390207         if(!has_child,
%o A390207             count++;
%o A390207         );
%o A390207     );
%o A390207     count;
%o A390207 }
%Y A390207 Cf. A333123, A389228, A389370.
%K A390207 nonn
%O A390207 1,5
%A A390207 _Miles Englezou_, Dec 02 2025
