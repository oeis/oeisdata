%I A390530 #26 Nov 24 2025 13:45:52
%S A390530 1,11,86,587,3690,21807,122638,662315,3459842,17583623,87340566,
%T A390530 425564739,2039969482,9642906719,45034323230,208116168539,
%U A390530 952910587410,4327603827255,19511146305190,87395584017395,389180265892826,1723893504123791,7599401792236206,33353516130942987
%N A390530 Weighted count of equivalence classes of words w of length n+3 over {a, b, c, d, A, *} having exactly n letters, exactly three *'s, an even number of lowercase a's, and weight (-1)^(A(w)), where A(w) is the number of uppercase letters A.
%C A390530 Two words are equivalent if they have the same set of lowercase positions, the same lowercase letters in those positions, and the same number of uppercase letters A (thus, permutations of A and * in the remaining positions are not distinguished).
%C A390530 This sequence is S(n, 1), where S(n,j) is the weighted count of the equivalence classes of words w of length N = n + 2*j + 1 over the alphabet {a, b, c, d, A, *}. Each word has exactly n letter positions, exactly 2*j+1 stars, an even number of lowercase a's among the lowercase letters, and weight (-1)^(A(w)), where A(w) is the number of uppercase letters A.
%H A390530 <a href="/index/Rec#order_08">Index entries for linear recurrences with constant coefficients</a>, signature (22,-207,1086,-3468,6888,-8288,5504,-1536).
%F A390530 a(n) = Sum_{k=0..n} (2^(n-k)+1)*2^(n-k-1)*binomial(n+2*j+1, n-k)*(-1)^k, with j = 1.
%F A390530 From _Stefano Spezia_, Nov 17 2025: (Start)
%F A390530 a(n) = (2^(n+1) - 3^(n+3) + 7*4^(n+1) + 2^n*n*(1 + 2^(n+1)*(n - 3) + n) - 1)/2.
%F A390530 G.f.: (1 - 11*x + 51*x^2 - 114*x^3 + 100*x^4)/((1 - x)*(1 - 2*x)^3*(1 - 3*x)*(1 - 4*x)^3).
%F A390530 E.g.f.: exp(x)*(exp(x)*(2 - 27*exp(x) + 4*x*(1 + x) + 4*exp(2*x)*(7 - 4*x + 8*x^2)) - 1)/2. (End)
%e A390530 a(0) = 1 since, for n = 0, the only equivalence class is *** with weight 1 and 1*1 = 1.
%e A390530 a(1) = 11 since, for n = 1, the equivalence classes are b***, c***, d***, *b**, *c**, *d**, **b*, **c*, **d*, ***b, ***c, ***d (all weight 1) and A*** (weight -1) and 12*1 + 1*(-1) = 11.
%p A390530 S := (n, j) -> add((2^(n-k) + 1) * 2^(n-k-1) * binomial(n + 2*j + 1, n - k) * (-1)^k, k = 0..n):
%p A390530 a := n -> S(n, 1):
%p A390530 seq(a(n), n=0..Nmax);
%t A390530 a[n_]:=(2^(n+1) - 3^(n+3) + 7*4^(n+1) + 2^n*n*(1 + 2^(n+1)*(n - 3) + n) - 1)/2; Array[a,24,0] (* _Stefano Spezia_, Nov 17 2025 *)
%o A390530 (Python)
%o A390530 from math import comb
%o A390530 def a(n): return sum((2**(n-k)+1)*2**(n-k-1)*comb(n+3, n-k)*(-1)**k for k in range(n)) + (-1)**n
%o A390530 print([a(n) for n in range(24)]) # _Michael S. Branicky_, Nov 15 2025
%Y A390530 Cf. A390529.
%K A390530 nonn,easy,new
%O A390530 0,2
%A A390530 _Akalu Tefera_ and Aklilu Zeleke, Nov 09 2025
%E A390530 More terms from _Michael S. Branicky_, Nov 15 2025
