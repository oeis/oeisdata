%I A390871 #48 Dec 11 2025 13:43:01
%S A390871 1,2,4,8,12,16,28,32,40,44,52,56,64,68,72,76,108,128,144,164,172,184,
%T A390871 212,232,256,296,412,428,512,528,544,668,684,708,788,852,1024,1048,
%U A390871 1052,1064,1160,1360,1388,1624,1708,1832,1936,2044,2048,2112,2192,2328,2344
%N A390871 Numbers k >= 1 such that k^2 - r^2 = 2^m - 1 for some 0 <= m <= k and 0 <= r < k.
%C A390871 A000079 is a subsequence of this sequence.
%C A390871 For k = A000079(n), the solutions (k, r, m) are (A000079(n), 1, 2*n), (A000079(n), A000079(n) - 1, n + 1).
%C A390871 For k != A000079(n), if there is a solution for k > 8, then m is from [A000523(k) + 3, 2*A000523(k) + 1] (I conjecture).
%C A390871 Empirical observation: for k >= 4, k == 0 (mod 4).
%C A390871 The observation is true because if m >= 3, 2^m - 1 == 7 (mod 8) and the only way to have k^2 - r^2 == 7 (mod 8) is k == 0 (mod 4) and r odd. - _Robert Israel_, Dec 01 2025
%C A390871 If m > 1 and 2^m - 1 = a*b with a,b positive integers, then (a + b)/2 is a term. - _Robert Israel_, Dec 01 2025
%H A390871 Robert Israel, <a href="/A390871/b390871.txt">Table of n, a(n) for n = 1..10000</a>
%e A390871 For k = 12: 12^2 - 9^2 = 2^6 - 1, thus 12 is a term.
%p A390871 N:= 10^5: # for terms <= N
%p A390871 Res:= {1}:
%p A390871 for m from 1 do
%p A390871   T:= 2^m-1; if T > N^2 then break fi;
%p A390871   for a in select(t -> t^2 < T, numtheory:-divisors(T)) do
%p A390871     v:= (a + T/a)/2;
%p A390871     if v <= N then Res:= Res union {v} fi;
%p A390871   od;
%p A390871 od:
%p A390871 sort(convert(Res,list));  # _Robert Israel_, Dec 01 2025
%t A390871 q[k_] := AnyTrue[Range[2, 2*Log2[k]], IntegerQ[Sqrt[k^2 - 2^# + 1]] &]; q[1] = True; Select[Range[2500], q] (* _Amiram Eldar_, Nov 22 2025 *)
%o A390871 (PARI) isp2(n) = 2^valuation(n, 2) == n;
%o A390871 isok(k) = for (r=0, k-1, if (isp2(k^2-r^2+1), return(1))); \\ _Michel Marcus_, Nov 22 2025
%o A390871 (PARI) isok(k) = for(m=1, logint(k^2+1, 2)+1, if (issquare(k^2+1-2^m), return(1))); \\ _Michel Marcus_, Dec 04 2025
%Y A390871 Cf. A000079, A000225, A000523.
%K A390871 nonn
%O A390871 1,2
%A A390871 _Ctibor O. Zizka_, Nov 22 2025
