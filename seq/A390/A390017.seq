%I A390017 #31 Feb 25 2026 21:34:00
%S A390017 1,12,1373,1351588,12205286340,1052448283624320,889222001627232733712,
%T A390017 7469884734861580853282463744,629544182831024885041590568490181696,
%U A390017 535473601489629196122338413108887490867200000,4615885302256832765923052326754346671425537580742662400
%N A390017 Number of perfect mazes on an n X n grid, including a discontiguous, nondirected pair of unit-length entry/exit openings in the border, with rotations and reflections not counted as distinct.
%C A390017 A perfect maze is one in which there exists exactly 1 self-avoiding path between any 2 cells in the grid. Congruent examples are nondistinct and collectively counted as 1, e.g.:
%C A390017      _ _       _ _ _       _ _ _
%C A390017   |_ _  |      _  |       |  _  |
%C A390017   |   | |     |  _| |     |_  | |
%C A390017   | |_ _| and |_ _ _| and  _ _|_  ...,
%C A390017   and the entry/exit pair must be discontiguous, e.g.:
%C A390017                _                      _       _ _
%C A390017   | | |     |  _                     | |       | |
%C A390017   |_ _| and |_ _| are counted, and |_ _| and  _ _| are not.
%C A390017 For n >= 3, the upper bound is A349718(n) * (A014635(n)-8), the number of distinct perfect mazes with complete borders times the maximum number of possible border entry/exit pair combinations for any maze. A014635 is all possible entry/exit pair combinations, at least 8 of which are contiguous for any maze of n >= 3; cases that yield additional contiguous entry/exit pairs and symmetrical cases reduce the realized total from the upper bound.
%C A390017 Counting the entry/exit pairs as directed gives A392623.
%H A390017 Andrew Howroyd, <a href="/A390017/b390017.txt">Table of n, a(n) for n = 1..30</a>
%H A390017 Andrew Howroyd, <a href="/A390017/a390017.txt">PARI program using Kirchhoff's Matrix Tree Theorem</a>, 2026.
%e A390017 a(2) = 12:
%e A390017           _      _      _      _      _
%e A390017 | | |  |_  |  |_  |  |_     |  _|  |  _|
%e A390017 |_ _|  |  _|   _ _|  |_ _|  |  _|  |_  |
%e A390017    _      _      _      _      _      _
%e A390017 |  _   |  _|  |   |  |   |  |      |   |
%e A390017 |_ _|  |_ _   | |_|  |_| |  |_|_|  |_|_
%o A390017 (PARI) vector(11,n,A390017(n)) \\ See Links for program code. - _Andrew Howroyd_, Feb 22 2026
%Y A390017 Cf. A349718, A014635, A392623.
%K A390017 nonn,new
%O A390017 1,2
%A A390017 _Charles L. Hohn_, Feb 12 2026
%E A390017 a(6) onward from _Andrew Howroyd_, Feb 18 2026
