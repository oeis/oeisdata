%I A390529 #30 Nov 24 2025 13:45:40
%S A390529 1,5,22,95,406,1715,7162,29615,121486,495275,2009602,8124935,32761366,
%T A390529 131834435,529712842,2125993055,8525430046,34166159195,136858084882,
%U A390529 548012945975,2193794127526,8780404589555,35137304693722,140596281975695,562526325893806,2250528914325515
%N A390529 Weighted count of equivalence classes of words w of length n+1 over {a, b, c, d, A, *} having exactly n letters, exactly one *, an even number of lowercase a's, and weight (-1)^(A(w)), where A(w) is the number of uppercase letters A.
%C A390529 Two words are equivalent if they have the same set of lowercase positions, the same lowercase letters in those positions, and the same number of uppercase letters A (thus, permutations of A and * in the remaining positions are not distinguished).
%C A390529 This sequence is S(n, 0), where S(n,j) is the weighted count of the equivalence classes of words w of length N = n + 2*j + 1 over the alphabet {a, b, c, d, A, *}. Each word has exactly n letter positions, exactly 2*j+1 stars, an even number of lowercase a's among the lowercase letters, and weight (-1)^(A(w)), where A(w) is the number of uppercase letters A.
%H A390529 <a href="/index/Rec#order_04">Index entries for linear recurrences with constant coefficients</a>, signature (10,-35,50,-24).
%F A390529 a(n) = Sum_{k=0..n} (2^(n-k)+1)*2^(n-k-1)*binomial(n+2*j+1, n-k)*(-1)^k, with j = 0.
%F A390529 From _Stefano Spezia_, Nov 17 2025: (Start)
%F A390529 a(n) = 2^n*(1 + 2^(n+1)) - (3^(n+1) + 1)/2.
%F A390529 G.f.: (1 - 5*x + 7*x^2)/((1 - x)*(1 - 2*x)*(1 - 3*x)*(1 - 4*x)).
%F A390529 E.g.f.: exp(x)*(2*exp(x) - 3*exp(2*x) + 4*exp(3*x) - 1)/2. (End)
%e A390529 a(0) = 1 since, for n = 0, the only equivalence class is * with weight 1 and 1*1 = 1.
%e A390529 a(1) = 5 since, for n = 1, the equivalence classes are b*, c*, d*, *b, *c, *d (all weight 1) and A* (weight -1), and 6*1 + 1*(-1) = 5.
%p A390529 S := (n, j) -> add((2^(n-k) + 1) * 2^(n-k-1) * binomial(n + 2*j + 1, n - k) * (-1)^k, k = 0..n):
%p A390529 a := n -> S(n, 0):
%p A390529 seq(a(n), n=0..Nmax);
%t A390529 a[n_]:=2^n*(1 + 2^(n+1)) - (3^(n+1) + 1)/2; Array[a,26,0] (* _Stefano Spezia_, Nov 17 2025 *)
%o A390529 (Python)
%o A390529 from math import comb
%o A390529 def a(n): return sum((2**(n-k)+1)*2**(n-k-1)*comb(n+1, n-k)*(-1)**k for k in range(n)) + (-1)**n
%o A390529 print([a(n) for n in range(26)]) # _Michael S. Branicky_, Nov 15 2025
%Y A390529 Cf. A390530.
%K A390529 nonn,easy,new
%O A390529 0,2
%A A390529 _Akalu Tefera_ and Aklilu Zeleke, Nov 09 2025
%E A390529 More terms from _Michael S. Branicky_, Nov 15 2025
