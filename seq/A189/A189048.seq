%I A189048 #51 Nov 05 2025 15:35:34
%S A189048 1,-1,23,-1,-11,-1,143,-1,-2527,-1,1416533,-1,-57341,-1,118522111,-1,
%T A189048 -5749735025,-1,91546452133,-1,-1792043646907,-1,1982765704676693,-1,
%U A189048 -286994513002493,-1,3187598700536922547,-1,-4625594563496048059399,-1,16555640873195841519871
%N A189048 Numerators of expansion of (Sum_{k=1..n} 1/k) - log(n+1/2) - gamma.
%C A189048 From _Natalia L. Skirrow_, Sep 04 2025: (Start)
%C A189048 Denominators are A189049; let q(n) = a(n)/A189049(n).
%C A189048 Occurs in the (formally valid but everywhere-divergent) Laurent series for the error of a variation of Stirling's approximation, from applying the Euler-Maclaurin formula: n! ~ sqrt(tau) * ((n+1/2)/e)^(n+1/2) * exp( Sum_{k>=1} -q(k+1)/(k*n^k) ).
%C A189048 This formula is sometimes attributed to Burnside, but was known to Stirling, who found it before his original approximation.
%C A189048 sqrt(tau) * ((n+1/2)/e)^(n+1/2) = exp(Integral_{x=n-1/2..n+1/2} log(x!) dx), via Raabe's integral; Stirling's original comes from integrating {x=n-1..n} and correcting for the offset by multiplying by sqrt(n).
%C A189048 The log-convexity of Gamma can thus be used to show that Stirling's nominal approximation is a lower bound and his original approximation is an upper bound.
%C A189048 The leading term of -1/(24*n) in this error is -1/2 times that of Stirling's approximation the formulation in the Borwein & Corless link explains this as a consequence of the midpoint rule being asymptotically twice as precise as the trapezoid rule.
%C A189048 This sequence is not explicitly mentioned in Borwein and Corless, but comes out of Theorem 2, eq. (57) via q(n+1) = -n/(-2)^n*Sum_{o=1..k} (2^o-1)*B_{o+1}*C(k-1,o-1)/(o*(o+1)) which can be proven with umbral calculus, using the identity B^n = (1+B)^n (where B^j is B_j).
%C A189048 (End)
%H A189048 Natalia L. Skirrow, <a href="/A189048/b189048.txt">Table of n, a(n) for n = 2..1024</a>
%H A189048 Jonathan M. Borwein and Robert M. Corless, <a href="https://doi.org/10.1080/00029890.2018.1420983">Gamma and Factorial in the Monthly</a>, Amer. Math. Monthly, 125(5) (2018), 400-424; <a href="https://arxiv.org/abs/1703.05349">arXiv version</a>, arXiv:1703.05349 [math.HO], 2017.
%H A189048 E. Chlebus, <a href="https://www.jstor.org/stable/10.4169/amer.math.monthly.118.03.268">A recursive scheme for improving the original rate of convergence to the Euler-Mascheroni constant</a>, Amer. Math. Monthly, 118 (2011), 268-274.
%H A189048 Peter Luschny, <a href="/wiki/User:Peter_Luschny/FactorialFunction">Approximations to the Factorial Function</a>
%H A189048 Natalia L. Skirrow, <a href="/wiki/User:Natalia_L._Skirrow/Stirling%27s_approximations">Stirling's approximations</a>
%F A189048 From _Natalia L. Skirrow_, Sep 04 2025: (Start)
%F A189048 With q(n) = a(n)/A189049(n) (when written in lowest terms),
%F A189048 q(n) = (1/(-2)^n - B(n))/n, where B(n) are the Bernoulli numbers.
%F A189048 E.g.f. for q(n): Ei(-x/2) + log(2/(1-e^-x)) - gamma.
%F A189048 E.g.f. for q(n+1): f(x) = (1/x - 1/(2*sinh(x/2))) / exp(x/2).
%F A189048 The series comes out of a Laplace transform representation, via Watson's lemma;
%F A189048 H_n - log(n+1/2) - gamma = Integral_{x=0..oo} f(x)/exp(n*x) dx.
%F A189048 (End)
%e A189048 1/(24n^2) - 1/(24n^3) + 23/(960*n^4) - 1/(160n^5) - 11/(8064*n^6) - 1/(896n^7) + 143/(30720*n^8) + ...
%p A189048 a := n -> numer(Zeta(1-n) + (-2)^(-n)/n): seq(a(n), n = 2..32); # _Peter Luschny_, Sep 09 2025
%t A189048 s = Sum[1/k, {k, 1, n}] - Log[n*(1 + 1/(2*n))] - EulerGamma; CoefficientList[ Series[s, {n, Infinity, 25}], 1/n][[3 ;; -1]] // Numerator (* _Jean-François Alcover_, Sep 12 2013 *)
%t A189048 Table[(1/(-2)^n-BernoulliB[n])/n,{n,2,27}]//Numerator (* _Natalia L. Skirrow_, Sep 04 2025 *)
%Y A189048 Cf. A189049 (denominators).
%K A189048 sign,frac
%O A189048 2,3
%A A189048 _N. J. A. Sloane_, Apr 16 2011
%E A189048 Corrected and extended by _Jean-François Alcover_, Sep 12 2013
