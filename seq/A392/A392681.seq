%I A392681 #20 Jan 29 2026 10:52:34
%S A392681 0,1,0,2,1,0,3,2,1,0,5,3,2,1,0,6,4,3,2,1,0,8,6,4,3,2,1,0,9,8,5,4,3,2,
%T A392681 1,0,12,9,7,5,4,3,2,1,0,13,11,9,6,5,4,3,2,1,0,16,13,11,8,6,5,4,3,2,1,
%U A392681 0,17,14,12,10,7,6,5,4,3,2,1,0
%N A392681 Square array read by upward antidiagonals: T(n,k) = sum of depths of leaves in a complete k-ary tree with n nodes; n >= 1, k >= 2.
%C A392681 For k >= n-1 >= 1, the tree is a root with n-1 leaves so sum of depths of leaves T(n,k) = n-1.
%H A392681 Paolo Xausa, <a href="/A392681/b392681.txt">Table of n, a(n) for n = 1..11325</a> (first 150 antidiagonals of the array, flattened).
%F A392681 T(n,k) = (n - M) + (h - 1)*L, where: h = floor(log_k(n*(k-1))), M = (k^h - 1)/(k - 1) is the number of nodes above the last level, L = n - floor((n + k - 2)/k) is the total number of leaves.
%e A392681 The array starts (rows n=1..10, columns k=2..9):
%e A392681   n\k |  2   3   4   5   6   7   8   9
%e A392681   ----+-------------------------------
%e A392681    1  |  0   0   0   0   0   0   0   0
%e A392681    2  |  1   1   1   1   1   1   1   1
%e A392681    3  |  2   2   2   2   2   2   2   2
%e A392681    4  |  3   3   3   3   3   3   3   3
%e A392681    5  |  5   4   4   4   4   4   4   4
%e A392681    6  |  6   6   5   5   5   5   5   5
%e A392681    7  |  8   8   7   6   6   6   6   6
%e A392681    8  |  9   9   9   8   7   7   7   7
%e A392681    9  | 12  11  11  10   9   8   8   8
%e A392681   10  | 13  13  12  12  11  10   9   9
%e A392681 For n=10, k=9: All 9 leaves are at depth 1. Sum = 9*1 = 9.
%t A392681 A392681[n_, k_]:= n - (k^#-1)/(k-1) + (#-1)*(n - Quotient[n+k-2, k]) & [Floor[Log[k, n*(k-1)]]];
%t A392681 Table[A392681[n-k+2, k], {n, 15}, {k, 2, n+1}] (* _Paolo Xausa_, Jan 29 2026 *)
%o A392681 (Python)
%o A392681 from sympy import integer_log
%o A392681 def T(n, k):
%o A392681     if n <= 1: return 0
%o A392681     h = integer_log(n * (k - 1), k)[0]
%o A392681     M = (k**h - 1) // (k - 1)
%o A392681     L = n - (n + k - 2) // k
%o A392681     return (n - M) + L * (h - 1)
%Y A392681 Cf. A390616 (column k=3), A392221 (column k=2). Cf. A000012 (row n=2), A001477 (values for k >= n-1).
%K A392681 nonn,tabl,easy,new
%O A392681 1,4
%A A392681 _Kaloian Ivanov_, Jan 19 2026
