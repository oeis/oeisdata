%I A392121 #6 Feb 22 2026 21:31:28
%S A392121 3,4,7,9,11,14,17,18,20,23,26,30,31,33,35,37,39,40,46,47,49,54,56,58,
%T A392121 62,63,64,67,69,70,73,74,78,80,83,84,86,92,93,98,100,101,105,106,107,
%U A392121 110,115,118,122,124,125,126,127,128,133,136,137,138,140,146
%N A392121 Indices of the upper Wythoff partition sequence of the primes; see A392117.
%C A392121 The sequences A392119 and A392121 partition the positive integers, A000027.
%F A392121 a(n) = A000720(A392118(n)).
%t A392121 Clear[generateSequenceFast];
%t A392121 s = Prime[Range[200]]  (* User: put your sequence s here. *)
%t A392121 generateSequenceFast[seq_] := Module[{seqLen = Length[seq], used, a, b, n = 1, pa = 1, pb = 1, bTarget}, used = ConstantArray[False, seqLen];
%t A392121    a = ConstantArray[0, seqLen]; b = a; a[[1]] = seq[[1]]; used[[1]] = True;
%t A392121    While[n <= seqLen, bTarget = a[[n]] + seq[[n]];
%t A392121     While[pb <= seqLen && (used[[pb]] || seq[[pb]] < bTarget), pb++];
%t A392121     If[pb > seqLen, Break[]];
%t A392121     b[[n]] = seq[[pb]]; used[[pb]] = True; pa = Max[pa, 2];
%t A392121     While[pa <= seqLen && used[[pa]], pa++];
%t A392121     If[pa > seqLen, Break[]]; a[[n + 1]] = seq[[pa]];
%t A392121     used[[pa]] = True; n++]; {Take[a, n], Take[b, n - 1]}];
%t A392121 u = generateSequenceFast[s]
%t A392121 v = PrimePi[generateSequenceFast[Prime[Range[200]]]]
%t A392121 First[u]  (* A392117*)
%t A392121 Last[u]   (* A392118 *)
%t A392121 (* _Peter J. C. Moses_, Dec 23 2025 *)
%t A392121 First[v]  (* A392119 *)
%t A392121 Last[v]   (* A392121 *)
%t A392121 (* _Peter J. C. Moses_, Dec 23 2025 *)
%Y A392121 Cf. A000040, A000720, A392117, A392119.
%K A392121 nonn,new
%O A392121 1,1
%A A392121 _Clark Kimberling_, Feb 17 2026
