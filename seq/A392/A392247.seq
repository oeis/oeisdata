%I A392247 #25 Jan 12 2026 14:50:09
%S A392247 1,192,456960,4377344000
%N A392247 Number of inequivalent chord diagrams on 8n points with 4n chords of distinct lengths 1, 2, ..., 4n.
%C A392247 This sequence counts the number of "Cyclic Skolem Sequences" of order M = 4n under dihedral equivalence corresponding to pairings of 2M points on a circle where the set of chord lengths is exactly {1, 2, ..., M}.
%C A392247 Each solution is encoded as a string of length 2M containing the symbols 0, 1, ..., M-1 exactly twice. The defining rule is that the two occurrences of symbol k are separated by exactly k characters along the shorter arc of the circle.
%C A392247 Canonicalization: Solutions are considered equivalent under rotation and reflection (dihedral group action). To determine the count, a solution fixes the "0-chord" (length 1, symbol '0') at the beginning of the string (forcing the prefix "00") and adopts the lexicographically smaller of the two mirror images.
%C A392247 The condition M == 0 or 1 (mod 4) is necessary for existence. This entry covers the case M == 0 (mod 4).
%C A392247 Factorization of terms for n=3 (M=12) and n=4 (M=16) suggests the high symmetry of 4k-gons favor highly composite) counts, in contrast to the M == 1 (mod 4) case (A390360) which produces large prime factors.
%C A392247 a(n) = KCounterFast(4*n) where KCounterFast is the GAP function defined in the Program section.
%H A392247 Paul Sampson, <a href="https://github.com/applutan/cyclic-skolem-sequences">Cyclic Skolem Sequences</a> (GitHub)
%H A392247 Paul Sampson, <a href="https://github.com/applutan/cyclic-skolem-sequences/tree/main/A392247_Even">Canonical solutions for 4n chords</a>
%e A392247 For n=2 (for M=8 chords on 16 vertices), there are 192 unique solutions. One example is "0024627345131675". We easily see 0()0, 1(3)1, 2(46)2, 3(451)3, 4(6273)4, 5(13167)5 and 7(3451316)7 with the requisite number of symbols between the 'counting' symbol. Although 6(27345131)6 looks like a separation by 8, the shorter 6(750024)6 is a wrapround.
%o A392247 (GAP)
%o A392247 # Counts inequivalent chord diagrams for OEIS A392247
%o A392247 # Note: This is a reference implementation. For N=12 (index n=3),
%o A392247 # this code correctly finds all 21,934,080 raw solutions, but
%o A392247 # OrbitsDomain exceeds standard memory limits before it can ultimately
%o A392247 # conclude that none of them are actually useful.
%o A392247 KCounterFast := function(n)
%o A392247     local nvx, sols, dhg, Backtrack;
%o A392247     nvx := 2*n;
%o A392247     sols := [];
%o A392247     Backtrack := function(mus, mln, cps, fnd)
%o A392247         local x, y, l;
%o A392247         if fnd = n then
%o A392247             Add(sols, Set(cps));
%o A392247             return;
%o A392247         fi;
%o A392247         x := Position(mus, false);
%o A392247         for y in [x+1 .. nvx] do
%o A392247             if mus[y] = false then
%o A392247                 l := Minimum(y - x, nvx - (y - x));
%o A392247                 if mln[l] = false then
%o A392247                     mus[x] := true; mus[y] := true;
%o A392247                     mln[l] := true;
%o A392247                     Add(cps, Set([x,y]));
%o A392247                     Backtrack(mus, mln, cps, fnd + 1);
%o A392247                     Remove(cps);
%o A392247                     mln[l] := false;
%o A392247                     mus[y] := false; mus[x] := false;
%o A392247                 fi;
%o A392247             fi;
%o A392247         od;
%o A392247     end;
%o A392247     Backtrack(ListWithIdenticalEntries(nvx, false), ListWithIdenticalEntries(n, false), [], 0);
%o A392247     if IsEmpty(sols) then return 0; fi;
%o A392247     dhg := Group(PermList(Concatenation([2..nvx], [1])), Product(List([1..n], i -> (i, nvx-i+1))));
%o A392247     return Size(OrbitsDomain(dhg, sols, OnSetsSets));
%o A392247 end;
%o A392247 # Wrapper for index n (counting 4n chords):
%o A392247 a := n -> KCounterFast(4*n);
%Y A392247 Cf. A390360 (the n == 1 mod 4 case), A001147 (total chord diagrams), A000931 (Skolem sequences).
%K A392247 nonn,more
%O A392247 1,2
%A A392247 _Paul Sampson_, Jan 04 2026
