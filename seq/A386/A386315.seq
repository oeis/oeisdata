%I A386315 #41 Feb 22 2026 12:07:04
%S A386315 1,12,12,36,12,84,36,108,12,108,84,132,36,180,108,252,12,204,108,228,
%T A386315 84,324,132,300,36,444,180,324,108,372,252,396,12,396,204,756,108,468,
%U A386315 228,540,84,492,324,516,132,756,300,588,36,780,444,612,180,660,324
%N A386315 Number of points in a face-centered cubic lattice that intersect a sphere of radius n centered on a point in the lattice.
%C A386315 For all n > 0, the points at the 4 90-degree rotations of [n, 0, 0] and the eight 90-degree rotations and vertical reflections of [n/2, n/2, n*sqrt(1/2)] form the 12 vertices of a cuboctahedron (shown in red in the Links example). Points that otherwise lie on an axis plane have 24-point symmetry (green), and all other points have 48-point symmetry (blue). Thus, a(n) for all n > 0 are odd multiples of 12.
%C A386315 The number of noncongruent points for each sphere radius n (points within or on vertices or edges of each symmetry region in the Links example) gives A387222, the number of those points that are primitive for radius n (darker colors) gives A387223 for odd sphere radii, and the total primitive count divided by 12 gives A278081 for odd sphere radii. Examples of nonprimitive points include [3, 0, 0] and [3/2, 3/2, 3*sqrt(1/2)] for a(3), which reduce to a(1) primitive points [1, 0, 0] and [1/2, 1/2, sqrt(1/2)] respectively.
%C A386315 Analog for the simple cubic lattice is A016725.
%H A386315 Chai Wah Wu, <a href="/A386315/b386315.txt">Table of n, a(n) for n = 0..10000</a>
%H A386315 Charles L. Hohn, <a href="/A386315/a386315_2.gif">a(0) to a(15), animated - see Comments</a>
%F A386315 a(n) = A004015(n^2).
%F A386315 a(2*n) = a(n).
%F A386315 a(p*n) = p*a(n) where p is a prime and p mod 8 is in {1, 3}.
%F A386315 a(p*n) = p*a(n) + 2*a(n/p^c) where p is a prime, p mod 8 is in {5, 7}, and c is the count of prime factors p in n.
%e A386315 a(3) = 36, which is the sum of 4 90-degree rotations of [3, 0, 0], 8 90-degree rotations and vertical reflections of [3/2, 3/2, 3*sqrt(1/2)] and [1, 0, 4*sqrt(1/2)], and 16 90-degree rotations and vertical and horizontal reflections of [5/2, 3/2, sqrt(1/2)].
%o A386315 (PARI) a(n)={my(c=0); for(x=0, n, for(y=0, min(x, sqrtint(n^2-x^2)), for(o=0, 1, my(m=2*(n^2-(x+o/2)^2-(y+o/2)^2)); if(!issquare(m), next); my(z=sqrtint(m)); if(z>=0 && z%2==o, c+=2^(4-if(!z, 1)-if(x==y, 1)-if(!min(x, y) && !o, 1)-if(!vecmax([x, y, z, o]), 1)))))); c}
%o A386315 (PARI) a(n)={if(!n, return(1)); my(f=Vec(factor(n)), o=12, r=o); for(i=if(#f[1] && f[1][1]==2, 2, 1), #f[1], my(m=if(f[1][i]%8>=4, 2)); f[2][i]++; while(f[2][i]--, o=o*f[1][i]+r*m); r=o); o}
%o A386315 (Python)
%o A386315 from math import prod, isqrt
%o A386315 from sympy import factorint
%o A386315 def A004018(n): return prod(1 if p==2 else (e+1 if p&3==1 else (e+1)&1) for p, e in factorint(n).items())<<2 if n else 1
%o A386315 def A386315(n): return A004018(m:=n**2<<1)+(sum(A004018(m-k**2) for k in range(1,isqrt(m)+1))<<1) # _Chai Wah Wu_, Feb 22 2026
%Y A386315 Cf. A004015, A016725.
%Y A386315 Cf. A387222, A387223, A278081.
%K A386315 nonn,look,changed
%O A386315 0,2
%A A386315 _Charles L. Hohn_, Aug 15 2025
