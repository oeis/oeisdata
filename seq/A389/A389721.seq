%I A389721 #19 Oct 21 2025 08:52:36
%S A389721 1,71,971,9871,99871,998717,9987617,99897617,998976197,9989796197,
%T A389721 99897963197,998979693197,9989796931979,99897969631979,
%U A389721 998979696321979,9989979696321979,99899796963219797,999899796963219797,9998997969653219797,99989979696593219797,999899796965932194797
%N A389721 a(n) is the greatest prime > a(n-1) obtained by inserting a single digit anywhere in its string of digits (including at the beginning or end), starting with a(1) = 1.
%C A389721 The last term is a(355) = A389720(a(355)).
%H A389721 Michael S. Branicky, <a href="/A389721/b389721.txt">Table of n, a(n) for n = 1..355</a>
%p A389721 f:= proc(n) local i,a,b,d,x,m;
%p A389721   m:= -infinity;
%p A389721   for i from 0 to 1+ilog10(n) do
%p A389721     b:= n mod 10^i;
%p A389721     a:= (n-b)/10^i;
%p A389721     for d from 9 by -1 to `if`(a=0,1,0) do
%p A389721       x:= (10*a+d)*10^i + b;
%p A389721       if x <= m then break fi;
%p A389721       if isprime(x) then m:= x; break fi;
%p A389721     od
%p A389721   od;
%p A389721   m
%p A389721 end proc:
%p A389721 R:= 1: x:= 1:
%p A389721 for n from 2 to 30 do
%p A389721   x:= f(x); R:= R,x
%p A389721 od:
%p A389721 R; # _Robert Israel_, Oct 12 2025
%o A389721 (Python)
%o A389721 from gmpy2 import is_prime
%o A389721 from itertools import islice
%o A389721 def f(n): # A389720
%o A389721     s = str(n)
%o A389721     return max((p for i in range(len(s)+1) for d in "0123456789" if is_prime(p:=int(s[:i]+d+s[i:]))), default=-1)
%o A389721 def agen(): # generator of terms
%o A389721     an, prevan = 1, -1
%o A389721     while an > prevan:
%o A389721         yield an
%o A389721         an, prevan = f(an), an
%o A389721 print(list(islice(agen(), 21)))
%Y A389721 Cf. A389720, A389722, A389723, A389724, A389725, A389726, A389727.
%Y A389721 Cf. A068166, A068167, A068168, A068169, A068170, A068171, A068172, A068173, A068174.
%K A389721 nonn,base,fini,full
%O A389721 1,2
%A A389721 _Michael S. Branicky_, Oct 12 2025
