%I A389370 #60 Dec 10 2025 16:11:23
%S A389370 0,1,2,2,4,2,4,3,4,4,4,2,6,6,6,4,6,4,6,8,7,9,4,3,8,8,6,6,8,7,6,5,10,6,
%T A389370 10,4,8,10,10,8,9,8,11,12,9,16,5,4,8,12,8,11,8,6,12,10,12,11,9,10,12,
%U A389370 12,10,6,12,14,8,10,16,12,6,4,10,12,14,11,14,10,10,12,8
%N A389370 a(n) is the length of the longest path in the rooted tree T_n defined in A390207 and in the comments.
%C A389370 T_n is constructed in the following way. With k_0 = n as the root, let k_i be a vertex of depth i. For a prime divisor p_i of k_i, let d_i = k_i/p_i. If m = k_i + (-1)^i*d_i does not appear in the path from k_0 to k_i, then m = k_{i+1}. Otherwise k_i is a terminal vertex.
%C A389370 T_n is finite for n > 0, and therefore a(n) is a positive integer for every n. See the Englezou link in A390207 for a proof.
%H A389370 Miles Englezou, <a href="/A389370/b389370.txt">Table of n, a(n) for n = 1..1494</a>
%e A389370 a(2) = 1 since the longest path is {2, 3}.
%e A389370 a(3) = 2 since the longest path is {3, 4, 2}.
%e A389370 a(10) = 4 since one of its longest paths is {10, 12, 6, 8, 4}.
%e A389370 a(15) = 6 since one of its longest paths is {15, 18, 9, 12, 6, 8, 4}.
%e A389370 The tree T_15 looks like this:
%e A389370            15
%e A389370          /    \
%e A389370       18       20
%e A389370      /  \     /   \
%e A389370     9    12  10   16
%e A389370     |    |   |    |
%e A389370     12   16  12   24
%e A389370    /  \  |  /  \  |
%e A389370   6    8 8 6    8 12
%e A389370   |        |      |
%e A389370   8        8      18
%e A389370   |        |      |
%e A389370   4        4      9
%o A389370 (PARI)
%o A389370 a(n) =
%o A389370 {
%o A389370     if(n == 1, return(0));
%o A389370     my(T = []);
%o A389370     my(S = [[n, 0, [n]]]);
%o A389370     while(#S,
%o A389370         my(t = S[#S]);
%o A389370         S = S[1..#S-1];
%o A389370         my(r = t[1], m = t[2], path = t[3]);
%o A389370         my(P = factor(r)[, 1]);
%o A389370         my(has_child = 0);
%o A389370         for(i = 1, #P,
%o A389370             my(d = r/P[i]);
%o A389370             my(s = r + (-1)^m * d);
%o A389370             if(!setsearch(path, s),
%o A389370                 has_child = 1;
%o A389370                 my(newpath = setunion(path, [s]));
%o A389370                 S = concat(S, [[s, m+1, newpath]]);
%o A389370             );
%o A389370         );
%o A389370         if(!has_child,
%o A389370             T = concat(T, #path)
%o A389370         );
%o A389370     );
%o A389370     vecmax(T) - 1;
%o A389370 }
%Y A389370 Cf. A333123, A389228, A390207.
%K A389370 nonn,new
%O A389370 1,3
%A A389370 _Miles Englezou_, Dec 02 2025
