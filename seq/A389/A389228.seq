%I A389228 #31 Dec 10 2025 16:21:23
%S A389228 0,1,2,2,2,1,4,3,2,2,2,2,4,3,4,4,4,1,4,2,2,2,2,2,4,4,4,4,4,3,6,5,3,3,
%T A389228 4,2,4,3,4,2,4,2,4,2,4,2,2,2,4,4,4,4,4,1,4,4,4,4,4,4,6,5,4,6,4,4,5,4,
%U A389228 4,4,4,2,4,4,4,4,4,4,4,2,4,4,4,2,4,4,4,2,4,3,4,2
%N A389228 a(n) is the length of the shortest path in the rooted tree T_n defined in A390207 and in the comments.
%C A389228 T_n is constructed in the following way. With k_0 = n as the root, let k_i be a vertex of depth i. For a prime divisor p_i of k_i, let d_i = k_i/p_i. If m = k_i + (-1)^i*d_i does not appear in the path from k_0 to k_i, then m = k_{i+1}. Otherwise k_i is a terminal vertex.
%H A389228 Miles Englezou, <a href="/A389228/b389228.txt">Table of n, a(n) for n = 1..10000</a>
%F A389228 a(n) = 1 if and only if n = 2*3^k, k >= 0.
%e A389228 a(2) = 1 since the shortest path is {2, 3}.
%e A389228 a(3) = 2 since the shortest path is {3, 4, 2}.
%e A389228 a(8) = 3 since the shortest path is {8, 12, 6, 9}.
%e A389228 a(19) = 4 since the shortest path is {19, 20, 10, 12, 8}.
%e A389228 The tree T_19 looks like this:
%e A389228              19
%e A389228              |
%e A389228              20
%e A389228             /   \
%e A389228            /     \
%e A389228          10       16
%e A389228         /  \      |
%e A389228       12    15    24
%e A389228      /  \   |     |
%e A389228     6    8  12    12
%e A389228    / \     /  \   |
%e A389228   8   9   16  18  18
%e A389228   |       |   |   |
%e A389228   4       8   9   9
%o A389228 (PARI)
%o A389228 a(n) =
%o A389228 {
%o A389228     if(n == 1, return(0));
%o A389228     my(T = []);
%o A389228     my(S = [[n, 0, [n]]]);
%o A389228     while(#S,
%o A389228         my(t = S[#S]);
%o A389228         S = S[1..#S-1];
%o A389228         my(r = t[1], m = t[2], path = t[3]);
%o A389228         my(P = factor(r)[, 1]);
%o A389228         my(has_child = 0);
%o A389228         for(i = 1, #P,
%o A389228             if(#T > 0 && #path >= T[#T], break);
%o A389228             my(d = r/P[i]);
%o A389228             my(s = r + (-1)^m * d);
%o A389228             if(!setsearch(path, s),
%o A389228                 has_child = 1;
%o A389228                 my(newpath = setunion(path, [s]));
%o A389228                 S = concat(S, [[s, m+1, newpath]]);
%o A389228             );
%o A389228         );
%o A389228         if(!has_child,
%o A389228             T = concat(T, #path);
%o A389228         );
%o A389228     );
%o A389228     vecmin(T) - 1;
%o A389228 }
%Y A389228 Cf. A333123, A389370, A390207.
%K A389228 nonn
%O A389228 1,3
%A A389228 _Miles Englezou_, Dec 01 2025
