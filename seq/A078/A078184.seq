%I A078184 #10 Feb 23 2026 09:36:33
%S A078184 0,20,60,128,228,380,440,684,860,1068,1328,1548,1940,2288,2484,2924,
%T A078184 3300,3824,4140,4700,5240,5484,6260,6864,7340,8180,8676,9392,9804,
%U A078184 10988,11208,12572,13100,13860,14792,15588,16604,17328,18500,19292
%N A078184 Number of solutions to n^2 < x^2 + y^2 + z^2 < (n+1)^2; number of lattice points between spheres of radii n and n+1.
%F A078184 a(n) = A078183(n+1) - A000605(n).
%t A078184 Table[Sum[SquaresR[3, k], {k, n^2 + 1, (n + 1)^2 - 1}], {n, 0, 50}]
%o A078184 (Python)
%o A078184 from math import isqrt, prod
%o A078184 from sympy import factorint
%o A078184 def A078184(n): return ((n+1<<1)+sum(1+((s:=isqrt(t:=(n+1+k)*(n+1-k)))<<1)+(sum(isqrt(t-m**2) for m in range(s+1))<<2) for k in range(1,n+2))<<1)-6*prod(p**e+(0 if p&3==1 else (p**e-1)//(p-1)<<1) for p,e in factorint(n+1>>(~(n+1) & n).bit_length()).items())-((n<<1)+sum(1+((s:=isqrt(t:=(n+k)*(n-k)))<<1)+(sum(isqrt(t-m**2) for m in range(s+1))<<2) for k in range(1,n+1))<<1) # _Chai Wah Wu_, Feb 22 2026
%Y A078184 Cf. A000605, A078183.
%K A078184 nonn,changed
%O A078184 0,2
%A A078184 _T. D. Noe_, Nov 21 2002
