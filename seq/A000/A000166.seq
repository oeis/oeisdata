%I A000166 M1937 N0766 #721 Nov 26 2025 15:59:31
%S A000166 1,0,1,2,9,44,265,1854,14833,133496,1334961,14684570,176214841,
%T A000166 2290792932,32071101049,481066515734,7697064251745,130850092279664,
%U A000166 2355301661033953,44750731559645106,895014631192902121,18795307255050944540,413496759611120779881,9510425471055777937262
%N A000166 Subfactorial or rencontres numbers, or derangements: number of permutations of n elements with no fixed points.
%C A000166 Euler (1809) not only gives the first ten or so terms of the sequence, he also proves both recurrences a(n) = (n-1)*(a(n-1) + a(n-2)) and a(n) = n*a(n-1) + (-1)^n.
%C A000166 a(n) is the permanent of the matrix with 0 on the diagonal and 1 elsewhere. - Yuval Dekel, Nov 01 2003
%C A000166 a(n) is the number of desarrangements of length n. A desarrangement of length n is a permutation p of {1,2,...,n} for which the smallest of all the ascents of p (taken to be n if there are no ascents) is even. Example: a(3) = 2 because we have 213 and 312 (smallest ascents at i = 2). See the J. Désarménien link and the Bona reference (p. 118). - _Emeric Deutsch_, Dec 28 2007
%C A000166 a(n) is the number of deco polyominoes of height n and having in the last column an even number of cells. A deco polyomino is a directed column-convex polyomino in which the height, measured along the diagonal, is attained only in the last column. - _Emeric Deutsch_, Dec 28 2007
%C A000166 Attributed to Nicholas Bernoulli in connection with a probability problem that he presented. See Problem #15, p. 494, in "History of Mathematics" by David M. Burton, 6th edition. - _Mohammad K. Azarian_, Feb 25 2008
%C A000166 a(n) is the number of permutations p of {1,2,...,n} with p(1)!=1 and having no right-to-left minima in consecutive positions. Example a(3) = 2 because we have 231 and 321. - _Emeric Deutsch_, Mar 12 2008
%C A000166 a(n) is the number of permutations p of {1,2,...,n} with p(n)! = n and having no left to right maxima in consecutive positions. Example a(3) = 2 because we have 312 and 321. - _Emeric Deutsch_, Mar 12 2008
%C A000166 Number of wedged (n-1)-spheres in the homotopy type of the Boolean complex of the complete graph K_n. - _Bridget Tenner_, Jun 04 2008
%C A000166 The only prime number in the sequence is 2. - Howard Berman (howard_berman(AT)hotmail.com), Nov 08 2008
%C A000166 From _Emeric Deutsch_, Apr 02 2009: (Start)
%C A000166 a(n) is the number of permutations of {1,2,...,n} having exactly one small ascent. A small ascent in a permutation (p_1,p_2,...,p_n) is a position i such that p_{i+1} - p_i = 1. (Example: a(3) = 2 because we have 312 and 231; see the Charalambides reference, pp. 176-180.) [See also David, Kendall and Barton, p. 263. - _N. J. A. Sloane_, Apr 11 2014]
%C A000166 a(n) is the number of permutations of {1,2,...,n} having exactly one small descent. A small descent in a permutation (p_1,p_2,...,p_n) is a position i such that p_i - p_{i+1} = 1. (Example: a(3)=2 because we have 132 and 213.) (End)
%C A000166 For n > 2, a(n) + a(n-1) = A000255(n-1); where A000255 = (1, 1, 3, 11, 53, ...). - _Gary W. Adamson_, Apr 16 2009
%C A000166 Connection to A002469 (game of mousetrap with n cards): A002469(n) = (n-2)*A000255(n-1) + A000166(n). (Cf. triangle A159610.) - _Gary W. Adamson_, Apr 17 2009
%C A000166 From _Emeric Deutsch_, Jul 18 2009: (Start)
%C A000166 a(n) is the sum of the values of the largest fixed points of all non-derangements of length n-1. Example: a(4)=9 because the non-derangements of length 3 are 123, 132, 213, and 321, having largest fixed points 3, 1, 3, and 2, respectively.
%C A000166 a(n) is the number of non-derangements of length n+1 for which the difference between the largest and smallest fixed point is 2. Example: a(3) = 2 because we have 1'43'2 and 32'14'; a(4) = 9 because we have 1'23'54, 1'43'52, 1'53'24, 52'34'1, 52'14'3, 32'54'1, 213'45', 243'15', and 413'25' (the extreme fixed points are marked).
%C A000166 (End)
%C A000166 a(n), n >= 1, is also the number of unordered necklaces with n beads, labeled differently from 1 to n, where each necklace has >= 2 beads. This produces the M2 multinomial formula involving partitions without part 1 given below. Because M2(p) counts the permutations with cycle structure given by partition p, this formula gives the number of permutations without fixed points (no 1-cycles), i.e., the derangements, hence the subfactorials with their recurrence relation and inputs. Each necklace with no beads is assumed to contribute a factor 1 in the counting, hence a(0)=1. This comment derives from a family of recurrences found by Malin Sjodahl for a combinatorial problem for certain quark and gluon diagrams (Feb 27 2010). - _Wolfdieter Lang_, Jun 01 2010
%C A000166 From _Emeric Deutsch_, Sep 06 2010: (Start)
%C A000166 a(n) is the number of permutations of {1,2,...,n, n+1} starting with 1 and having no successions. A succession in a permutation (p_1,p_2,...,p_n) is a position i such that p_{i+1} - p_i = 1. Example: a(3)=2 because we have 1324 and 1432.
%C A000166 a(n) is the number of permutations of {1,2,...,n} that do not start with 1 and have no successions. A succession in a permutation (p_1,p_2,...,p_n) is a position i such that p_{i+1} - p_i = 1. Example: a(3)=2 because we have 213 and 321.
%C A000166 (End)
%C A000166 Increasing colored 1-2 trees with choice of two colors for the rightmost branch of nonleave except on the leftmost path, there is no vertex of outdegree one on the leftmost path. - _Wenjin Woan_, May 23 2011
%C A000166 a(n) is the number of zeros in n-th row of the triangle in A170942, n > 0. - _Reinhard Zumkeller_, Mar 29 2012
%C A000166 a(n) is the maximal number of totally mixed Nash equilibria in games of n players, each with 2 pure options. - _Raimundas Vidunas_, Jan 22 2014
%C A000166 Convolution of sequence A135799 with the sequence generated by 1+x^2/(2*x+1). - _Thomas Baruchel_, Jan 08 2016
%C A000166 The number of interior lattice points of the subpolytope of the n-dimensional permutohedron whose vertices correspond to permutations avoiding 132 and 312. - _Robert Davis_, Oct 05 2016
%C A000166 Consider n circles of different radii, where each circle is either put inside some bigger circle or contains a smaller circle inside it (no common points are allowed). Then a(n) gives the number of such combinations. - _Anton Zakharov_, Oct 12 2016
%C A000166 If we partition the permutations of [n+1] in A000240 according to their starting digit, we will get (n+1) equinumerous classes each of size a(n), i.e., A000240(n+1) = (n+1)*a(n), hence a(n) is the size of each class of permutations of [n+1] in A000240. For example, for n = 4 we have 45 = 5*9. - _Enrique Navarrete_, Jan 10 2017
%C A000166 Call d_n1 the permutations of [n] that have the substring n1 but no substring in {12,23,...,(n-1)n}. If we partition them according to their starting digit, we will get (n-1) equinumerous classes each of size A000166(n-2) (the class starting with the digit 1 is empty since we must have the substring n1). Hence d_n1 = (n-1)*A000166(n-2) and A000166(n-2) is the size of each nonempty class in d_n1. For example, d_71 = 6*44 = 264, so there are 264 permutations in d_71 distributed in 6 nonempty classes of size A000166(5) = 44. (To get permutations in d_n1 recursively from more basic ones see the link "Forbidden Patterns" below.) - _Enrique Navarrete_, Jan 15 2017
%C A000166 Also the number of maximum matchings and minimum edge covers in the n-crown graph. - _Eric W. Weisstein_, Jun 14 and Dec 24 2017
%C A000166 The sequence a(n) taken modulo a positive integer k is periodic with exact period dividing k when k is even and dividing 2*k when k is odd. This follows from the congruence a(n+k) = (-1)^k*a(n) (mod k) for all n and k, which in turn is easily proved by induction making use of the recurrence a(n) = n*a(n-1) + (-1)^n. - _Peter Bala_, Nov 21 2017
%C A000166 a(n) is the number of distinct possible solutions for a directed, no self loop containing graph (not necessarily connected) that has n vertices, and each vertex has an in- and out-degree of exactly 1. - _Patrik Holopainen_, Sep 18 2018
%C A000166 a(n) is the dimension of the kernel of the random-to-top and random-to-random shuffling operators over a collection of n objects (in a vector space of size n!), as noticed by M. Wachs and V. Reiner. See the Reiner, Saliola and Welker reference below. - _Nadia Lafreniere_, Jul 18 2019
%C A000166 a(n) is the number of distinct permutations for a Secret Santa gift exchange with n participants. - _Patrik Holopainen_, Dec 30 2019
%C A000166 a(2*n+1) is even. More generally, a(m*n+1) is divisible by m*n, which follows from a(n+1) = n*(a(n) + a(n-1)) = n*A000255(n-1) for n >= 1. a(2*n) is odd; in fact, a(2*n) == 1 (mod 8). Other divisibility properties include a(6*n) == 1 (mod 24), a(9*n+4) == a(9*n+7) == 0 (mod 9), a(10*n) == 1 (mod 40), a(11*n+5) == 0 (mod 11) and a(13*n+8 ) == 0 (mod 13). - _Peter Bala_, Apr 05 2022
%C A000166 Conjecture: a(n) with n > 2 is a perfect power only for n = 4 with a(4) = 3^2. This has been verified for n <= 1000. - _Zhi-Wei Sun_, Jan 09 2025
%D A000166 U. Abel, Some new identities for derangement numbers, Fib. Q., 56:4 (2018), 313-318.
%D A000166 M. Bona, Combinatorics of Permutations, Chapman & Hall/CRC, Boca Raton, Florida, 2004.
%D A000166 Miklos Bona, editor, Handbook of Enumerative Combinatorics, CRC Press, 2015, page 32.
%D A000166 R. A. Brualdi and H. J. Ryser: Combinatorial Matrix Theory, 1992, Section 7.2, p. 202.
%D A000166 Ch. A. Charalambides, Enumerative Combinatorics, Chapman & Hall/CRC, Boca Raton, Florida, 2002.
%D A000166 L. Comtet, Advanced Combinatorics, Reidel, 1974, p. 182.
%D A000166 Florence Nightingale David and D. E. Barton, Combinatorial Chance. Hafner, NY, 1962, p. 168.
%D A000166 Florence Nightingale David, Maurice George Kendall, and D. E. Barton, Symmetric Function and Allied Tables, Cambridge, 1966, p. 263, Table 7.5.1, row 1.
%D A000166 P. R. de Montmort, On the Game of Thirteen (1713), reprinted in Annotated Readings in the History of Statistics, ed. H. A. David and A. W. F. Edwards, Springer-Verlag, 2001, pp. 25-29.
%D A000166 J. M. de Saint-Martin, "Le problème des rencontres" in Quadrature, No. 61, pp. 14-19, 2006, EDP-Sciences Les Ulis (France).
%D A000166 H. Doerrie, 100 Great Problems of Elementary Mathematics, Dover, NY, 1965, p. 19.
%D A000166 Leonhard Euler, Solution quaestionis curiosae ex doctrina combinationum, Mémoires Académie sciences St. Pétersburg 3 (1809/1810), 57-64; also E738 in his Collected Works, series I, volume 7, pages 435-440.
%D A000166 J. M. Gandhi, On logarithmic numbers, Math. Student, 31 (1963), 73-83.
%D A000166 A. Hald, A History of Probability and Statistics and Their Applications Before 1750, Wiley, NY, 1990 (Chapter 19).
%D A000166 Irving Kaplansky, John Riordan, The problème des ménages. Scripta Math. 12 (1946), 113-124. See Eq(1).
%D A000166 Arnold Kaufmann, "Introduction à la combinatorique en vue des applications." Dunod, Paris, 1968. See p. 92.
%D A000166 Florian Kerschbaum and Orestis Terzidis, Filtering for Private Collaborative Benchmarking, in Emerging Trends in Information and Communication Security, Lecture Notes in Computer Science, Volume 3995/2006.
%D A000166 E. Lozansky and C. Rousseau, Winning Solutions, Springer, 1996; see p. 152.
%D A000166 P. A. MacMahon, Combinatory Analysis, 2 vols., Chelsea, NY, 1960, see p. 102.
%D A000166 M. S. Petković, "Non-attacking rooks", Famous Puzzles of Great Mathematicians, pp. 265-268, Amer. Math. Soc.(AMS), 2009.
%D A000166 V. Reiner, F. Saliola, and V. Welker. Spectra of Symmetrized Shuffling Operators, Memoirs of the American Mathematical Society, vol. 228, Amer. Math. Soc., Providence, RI, 2014, pp. 1-121. See section VI.9.
%D A000166 J. Riordan, An Introduction to Combinatorial Analysis, Wiley, 1958, p. 65.
%D A000166 H. J. Ryser, Combinatorial Mathematics. Mathematical Association of America, Carus Mathematical Monograph 14, 1963, p. 23.
%D A000166 T. Simpson, Permutations with unique fixed and reflected points. Ars Combin. 39 (1995), 97-108.
%D A000166 N. J. A. Sloane, A Handbook of Integer Sequences, Academic Press, 1973 (includes this sequence).
%D A000166 N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence).
%D A000166 David Wells, The Penguin Dictionary of Curious and Interesting Numbers. Penguin Books, NY, 1986, Revised edition 1987. See p. 122.
%D A000166 D. B. West, Combinatorial Mathematics, Cambridge, 2021, p. 82.
%D A000166 H. S. Wilf, Generatingfunctionology, Academic Press, NY, 1990, p. 147, Eq. 5.2.9 (q=1).
%H A000166 Seiichi Manyama, <a href="/A000166/b000166.txt">Table of n, a(n) for n = 0..450</a> (terms 0..200 from T. D. Noe)
%H A000166 Christian Aebi and Grant Cairns, <a href="https://www.jstor.org/stable/10.4169/amer.math.monthly.122.5.433">Generalizations of Wilson's Theorem for Double-, Hyper-, Sub-and Superfactorials</a>, The American Mathematical Monthly 122.5 (2015): 433-443.
%H A000166 Joerg Arndt, <a href="http://jjj.de/pub/arndt-rand-perm-thesis.pdf">Generating Random Permutations</a>, PhD thesis, Australian National University, Canberra, Australia, (2010).
%H A000166 Joerg Arndt, <a href="http://www.jjj.de/fxt/#fxtbook">Matters Computational (The Fxtbook)</a>, p. 280.
%H A000166 Etor Arza, Aritz Perez, Ekhine Irurozki, and Josu Ceberio, <a href="https://arxiv.org/abs/1910.08800">Kernels of Mallows Models under the Hamming Distance for solving the Quadratic Assignment Problem</a>, arXiv:1910.08800 [stat.ML], 2019.
%H A000166 Roland Bacher, <a href="https://doi.org/10.37236/2522">Counting Packings of Generic Subsets in Finite Groups</a>, Electr. J. Combinatorics, 19 (2012), #P7.
%H A000166 Roland Bacher and P. De La Harpe, <a href="https://arxiv.org/abs/1603.07943">Conjugacy growth series of some infinitely generated groups</a>, arXiv:1603.07943 [math.GR], 2016.
%H A000166 Barry Balof and Helen Jenne , <a href="https://cs.uwaterloo.ca/journals/JIS/VOL17/Balof/balof22.html">Tilings, Continued Fractions, Derangements, Scramblings, and e</a>, Journal of Integer Sequences, 17 (2014), #14.2.7.
%H A000166 Vladimir Baltić, <a href="https://doi.org/10.2298/AADM1000008B">On the number of certain types of strongly restricted permutations</a>, Appl. An. Disc. Math. (2010) Vol. 4, Issue 1, 119-135.
%H A000166 Elena Barcucci, Alberto Del Lungo, and Renzo Pinzani, <a href="https://doi.org/10.1016/0304-3975(95)00199-9">"Deco" polyominoes, permutations and random generation</a>, Theoretical Computer Science, 159, 1996, 29-42.
%H A000166 Daniel Barsky, <a href="https://www.mat.univie.ac.at/~slc/opapers/s05barsky.html">Analyse p-adique et suites classiques de nombres</a>, Sem. Loth. Comb. B05b (1981) 1-21.
%H A000166 Arthur T. Benjamin and Joel Ornstein, <a href="https://www.fq.math.ca/Papers1/55-5/BenjaminOrnstein.pdf">A bijective proof of a derangement recurrence</a>, Fibonacci Quart., 55(5):28-29, 2017.
%H A000166 H. Bergeron, E. M. F. Curado, J. P. Gazeau, and Ligia M. C. S. Rodrigues, <a href="https://arxiv.org/abs/1309.6910">A note about combinatorial sequences and Incomplete Gamma function</a>, arXiv preprint arXiv: 1309.6910 [math.CO], 2013.
%H A000166 Natasha Blitvić and Einar Steingrímsson, <a href="https://arxiv.org/abs/2001.00280">Permutations, moments, measures</a>, arXiv:2001.00280 [math.CO], 2020.
%H A000166 Barry Brent, <a href="https://www.researchgate.net/publication/396925031_RAMANUJAN%27S_FUNCTION_ON_SMALL_PRIMES">Ramanujan's function on small primes</a>, ResearchGate, 2025.
%H A000166 Stefano Capparelli, Margherita Maria Ferrari, Emanuele Munarini, and Norma Zagaglia Salvi, <a href="https://cs.uwaterloo.ca/journals/JIS/VOL21/Munarini/muna8.html">A Generalization of the "Problème des Rencontres"</a>, J. Int. Seq. 21 (2018), #18.2.8.
%H A000166 Lapo Cioni and Luca Ferrari, <a href="https://arxiv.org/abs/2102.07628">Preimages under the Queuesort algorithm</a>, arXiv preprint arXiv:2102.07628 [math.CO], 2021; Discrete Math., 344 (2021), #112561.
%H A000166 Predrag Cvitanović, <a href="https://doi.org/10.1103/PhysRevD.14.1536">Group theory for Feynman diagrams in non-Abelian gauge theories</a>, Phys. Rev. D14 (1976), 1536-1553.
%H A000166 Sajal K. Das and Narsingh Deo, <a href="https://www.fq.math.ca/Scanned/25-3/das.pdf">Rencontres graphs: a family of bipartite graphs</a>, Fib. Quart., Vol. 25, No. 3, August 1987, 250-262.
%H A000166 Robert Davis and Bruce Sagan, <a href="https://arxiv.org/abs/1609.01782">Pattern-Avoiding Polytopes</a>, arXiv:1609.01782 [math.CO], 2016.
%H A000166 Jacques Désarménien, <a href="https://www.mat.univie.ac.at/~slc/opapers/s08desar.html">Une autre interprétation du nombre de dérangements</a>, Sem. Loth. Comb. B08b (1982) 11-16.
%H A000166 Emeric Deutsch and Sergi Elizalde, <a href="https://arxiv.org/abs/0904.2792">The largest and the smallest fixed points of permutations</a>, arXiv:0904.2792 [math.CO], 2009.
%H A000166 Robert M. Dickau, <a href="https://web.archive.org/web/20201101111430/http://mathforum.org/advanced/robertd/derangements.html">Derangement diagrams</a>.
%H A000166 Tomislav Došlić and Darko Veljan, <a href="https://doi.org/10.1016/j.disc.2007.04.066">Logarithmic behavior of some combinatorial sequences</a>, Discrete Math. 308 (2008), no. 11, 2182--2212. MR2404544 (2009j:05019).
%H A000166 Philippe Duchon and Romaric Duvignau, <a href="https://doi.org/10.46298/dmtcs.2433">A new generation tree for permutations</a>, FPSAC 2014, Chicago, USA; Discrete Mathematics and Theoretical Computer Science (DMTCS) Proceedings, 2014, 679-690.
%H A000166 James East and Robert Gray, <a href="https://arxiv.org/abs/:1404.2359">Diagram monoids and Graham-Houghton graphs: idempotents and generating sets of ideals</a>, arXiv:1404.2359 [math.GR], 2014.
%H A000166 Sergi Elizalde, <a href="https://arxiv.org/abs/2005.11312">A simple bijective proof of a familiar derangement recurrence</a>, arXiv:2005.11312 [math.CO], 2020.
%H A000166 Uriel Feige, <a href="http://www.wisdom.weizmann.ac.il/~feige/mypapers/OnlineMatchingFeige2018.pdf">Tighter bounds for online bipartite matching</a>, 2018.
%H A000166 Philip Feinsilver and John McSorley, <a href="https://doi.org/10.1155/2011/539030">Zeons, Permanents, the Johnson Scheme, and Generalized Derangements</a>, International Journal of Combinatorics, Volume 2011, Article ID 539030, 29 pages.
%H A000166 FindStat - Combinatorial Statistic Finder, <a href="http://www.findstat.org/St000022">The number of fixed points of a permutation</a>.
%H A000166 H. Fripertinger, <a href="http://www-ang.kfunigraz.ac.at/~fripert/fga/k1rencontre.html">The Rencontre Numbers</a>. [Broken link]
%H A000166 Hannah Fry and Brady Haran, <a href="https://www.youtube.com/watch?v=5kC5k5QBqcc">The Problems with Secret Santa</a>, Numberphile video (2016).
%H A000166 Jason Fulman and Robert Guralnick, <a href="https://arxiv.org/abs/math/0208022">Derangements in simple and primitive groups</a>, arXiv:math/0208022 [math.GR], 2002.
%H A000166 J. M. Gandhi, <a href="/A002741/a002741.pdf">On logarithmic numbers</a>, Math. Student, 31 (1963), 73-83. [Annotated scanned copy]
%H A000166 Zbigniew Gołębiewski and Mateusz Klimczak, <a href="https://doi.org/10.1137/1.9781611975505.5">Protection Number of Recursive Trees</a>, 2019 Proceedings of the Sixteenth Workshop on Analytic Algorithmics and Combinatorics (ANALCO).
%H A000166 Óscar González, Carlos Beltrán, and Ignacio Santamaría, <a href="https://arxiv.org/abs/1301.6196">On the Number of Interference Alignment Solutions for the K-User MIMO Channel with Constant Coefficients</a>, arXiv preprint arXiv:1301.6196 [cs.IT], 2013.
%H A000166 Gary Gordon and Elizabeth McMahon, <a href="https://www.jstor.org/stable/10.4169/000298910X523353">Moving faces to other places: facet derangements</a>, Amer. Math. Monthly, 117 (2010), 865-88.
%H A000166 Shyam Sunder Gupta, <a href="https://doi.org/10.1007/978-981-97-2465-9_16">Fascinating Factorials</a>, Exploring the Beauty of Fascinating Numbers, Springer (2025) Ch. 16, 411-442.
%H A000166 Richard K. Guy and Richard J. Nowakowski, <a href="/A002467/a002467_1.pdf">Mousetrap</a>, Preprint, Feb 10 1993. [Annotated scanned copy]
%H A000166 Amihay Hanany, Vishnu Jejjala, Sanjaye Ramgoolam, and Rak-Kyeong Seong, <a href="https://arxiv.org/abs/1512.09013">Consistency and Derangements in Brane Tilings</a>, arXiv:1512.09013 [hep-th], 2015.
%H A000166 Mehdi Hassani, <a href="http://www.cs.uwaterloo.ca/journals/JIS/VOL6/Hassani/hassani5.html">Derangements and Applications</a>, Journal of Integer Sequences, Vol. 6 (2003), #03.1.2.
%H A000166 Mehdi Hassani, <a href="https://arxiv.org/abs/math/0606613">Counting and computing by e</a>, arXiv:math/0606613 [math.CO], 2006.
%H A000166 Nick Hobson, <a href="/A000166/a000166.py.txt">Python program</a>.
%H A000166 Qing-Hu Hou, Zhi-Wei Sun, and Haomin Wen, <a href="https://arxiv.org/abs/1208.3903">On monotonicity of some combinatorial sequences</a>, arXiv:1208.3903 [math.CO], 2012-2014.
%H A000166 INRIA Algorithms Project, <a href="http://ecs.inria.fr/services/structure?nbr=21">Encyclopedia of Combinatorial Structures 21</a>.
%H A000166 Ekhine Irurozki, Borja Calvo, José A. Lozano, <a href="https://addi.ehu.es/bitstream/10810/11240/1/tr14-3.pdf">Sampling and learning the Mallows and Weighted Mallows models under the Hamming distance</a>, 2014.
%H A000166 Ekhine Irurozki, B. Calvo, and J. A. Lozano, <a href="http://dx.doi.org/10.18637/jss.v071.i12">PerMallows: An R Package for Mallows and Generalized Mallows Models</a>, Journal of Statistical Software, August 2016, Volume 71, Issue 12. doi: 10.18637/jss.v071.i12.
%H A000166 Milan Janjic, <a href="https://cs.uwaterloo.ca/journals/JIS/VOL15/Janjic/janjic42.html">Determinants and Recurrence Sequences</a>, Journal of Integer Sequences, 2012, Article 12.3.5.
%H A000166 Shirali Kadyrov and Farukh Mashurov, <a href="https://arxiv.org/abs/1912.03214">Generalized continued fraction expansions for Pi and E</a>, arXiv:1912.03214 [math.NT], 2019.
%H A000166 Irving Kaplansky and John Riordan, <a href="/A000166/a000166_1.pdf">The problème des ménages</a>, Scripta Math. 12, (1946), 113-124. [Scan of annotated copy]
%H A000166 Vaclav Kotesovec, <a href="https://oeis.org/wiki/User:Vaclav_Kotesovec">Non-attacking chess pieces</a>, 6ed, 2013, p. 220.
%H A000166 Arnold Richard Kräuter, <a href="https://www.mat.univie.ac.at/~slc/opapers/s11kraeu.html">Über die Permanente gewisser zirkulärer Matrizen...</a>, Séminaire Lotharingien de Combinatoire, B11b (1984), 11 pp.
%H A000166 John W. Layman, <a href="https://www.cs.uwaterloo.ca/journals/JIS/VOL4/LAYMAN/hankel.html">The Hankel Transform and Some of its Properties</a>, J. Integer Sequences, 4 (2001), #01.1.5.
%H A000166 Les Tablettes du Chercheur, <a href="https://gallica.bnf.fr/ark:/12148/bpt6k5816213c/f11.double">52. Combinaisons</a>, pp. 10-11, Dec 01 1890.
%H A000166 Rui-Li Liu and Feng-Zhen Zhao, <a href="https://cs.uwaterloo.ca/journals/JIS/VOL21/Liu/liu19.html">New Sufficient Conditions for Log-Balancedness, With Applications to Combinatorial Sequences</a>, J. Int. Seq., Vol. 21 (2018), Article 18.5.7.
%H A000166 Édouard Lucas, <a href="/A000899/a000899.pdf">Théorie des nombres</a> (annotated scans of a few selected pages).
%H A000166 Toufik Mansour and Mark Shattuck, <a href="https://doi.org/10.1016/j.disc.2015.12.004">Counting permutations by the number of successors within cycles</a>, Discr. Math., 339 (2016), 1368-1376.
%H A000166 Richard J. Martin and Michael J. Kearney, <a href="http://dx.doi.org/10.1007/s00493-014-3183-3">Integral representation of certain combinatorial recurrences</a>, Combinatorica: 35:3 (2015), 309-315.
%H A000166 Ivica Martinjak and Dajana Stanić, <a href="https://arxiv.org/abs/1711.04537">A Short Combinatorial Proof of Derangement Identity</a>, arXiv:1711.04537 [math.CO], 2017.
%H A000166 Richard D McKelvey and Andrew McLennan , <a href="https://doi.org/10.1006/jeth.1996.2214">The maximal number of regular totally mixed Nash equilibria</a>, J. Economic Theory, 72:411--425, 1997.
%H A000166 J. R. G. Mendonça, <a href="https://arxiv.org/abs/1809.04571">On the uniform generation of random derangements</a>, arXiv:1809.04571 [stat.CO], 2018.
%H A000166 Romeo Mestrovic, <a href="https://arxiv.org/abs/1312.7037">Variations of Kurepa's left factorial hypothesis</a>, arXiv preprint arXiv:1312.7037 [math.NT], 2013.
%H A000166 Emanuele Munarini, <a href="https://cs.uwaterloo.ca/journals/JIS/VOL23/Munarini/muna6.html">q-Derangement Identities</a>, J. Int. Seq., Vol. 23 (2020), Article 20.3.8.
%H A000166 Emanuele Munarini, <a href="https://cs.uwaterloo.ca/journals/JIS/VOL26/Munarini/muna25.html">Two-Parameter Identities for q-Appell Polynomials</a>, Journal of Integer Sequences, Vol. 26 (2023), Article 23.3.1.
%H A000166 Enrique Navarrete, <a href="https://arxiv.org/abs/1610.01987">Forbidden Patterns and the Alternating Derangement Sequence</a>, arXiv:1610.01987 [math.CO], 2016.
%H A000166 Andrew O'Desky and David Harry Richman, <a href="https://arxiv.org/abs/2012.04615">Derangements and the p-adic incomplete gamma function</a>, arXiv:2012.04615 [math.NT], 2020.
%H A000166 Rudolf Ondrejka, <a href="https://doi.org/10.1090/S0025-5718-67-99141-7">The first 100 exact subfactorials (Review)</a>, Math. Comp., 21 (1967), 502.
%H A000166 Hyungju Park, <a href="https://cs.uwaterloo.ca/journals/JIS/VOL26/Park2/park12.html">An Asymptotic Formula for the Number of Stabilized-Interval-Free Permutations</a>, J. Int. Seq. (2023) Vol. 26, Art. 23.9.3.
%H A000166 Paul Peart and Wen-Jin Woan, <a href="https://www.cs.uwaterloo.ca/journals/JIS/VOL3/PEART/peart1.html">Generating Functions via Hankel and Stieltjes Matrices</a>, J. Integer Seqs., Vol. 3 (2000), #00.2.1.
%H A000166 Alexsandar Petojevic, <a href="https://www.cs.uwaterloo.ca/journals/JIS/VOL5/Petojevic/petojevic5.html">The Function vM_m(s; a; z) and Some Well-Known Sequences</a>, Journal of Integer Sequences, Vol. 5 (2002), Article 02.1.7.
%H A000166 Simon Plouffe, <a href="http://plouffe.fr/simon/exact.htm">Exact formulas for integer sequences</a>.
%H A000166 Kári Ragnarsson and Bridget Eileen Tenner, <a href="https://doi.org/10.1016/j.aim.2009.05.007">Homotopy type of the Boolean complex of a Coxeter system</a>, Adv. Math. 222 (2009), 409-430.
%H A000166 Jeffrey B. Remmel, <a href="https://doi.org/10.1016/S0195-6698(83)80034-1">A note on a recursion for the number of derangements</a>, European J. Combin., 4(4):371-374, 1983.
%H A000166 John Riordan, <a href="/A002720/a002720_3.pdf">Letter to N. J. A. Sloane, Sep 26 1980 with notes on the 1973 Handbook of Integer Sequences</a>. Note that the sequences are identified by their N-numbers, not their A-numbers.
%H A000166 Max Rumney and E. J. F. Primrose, <a href="https://www.jstor.org/stable/3611860">A sequence connected with the subfactorial sequence, Note 3207</a>, Math. Gaz. 52 (1968), 381-382.
%H A000166 Max Rumney and E. J. F. Primrose, <a href="/A000255/a000255.pdf">A sequence connected with the subfactorial sequence</a>, Note 3207, Math. Gaz. 52 (1968), 381-382. [Annotated scanned copy]
%H A000166 Ed Sandifer, How Euler Did It, <a href="https://web.archive.org/web/20230928102914/https://www.maa.org/sites/default/files/pdf/editorial/euler/How%20Euler%20Did%20It%2011%20Derangements.pdf">Derangements</a>.
%H A000166 Mark Shattuck, <a href="https://arxiv.org/abs/:1401.6588">Combinatorial proofs of some Bell number formulas</a>, arXiv:1401.6588 [math.CO], 2014.
%H A000166 Todd Simpson, <a href="/A007016/a007016.pdf">Permutations with unique fixed and reflected points</a>, Preprint. (Annotated scanned copy)
%H A000166 Michael Z. Spivey and Laura L. Steil, <a href="https://www.cs.uwaterloo.ca/journals/JIS/VOL9/Spivey/spivey7.html">The k-Binomial Transforms and the Hankel Transform</a>, Journal of Integer Sequences, Vol. 9 (2006), Article 06.1.1.
%H A000166 Rebecca J. Stones, Sheng Lin, Xiaoguang Liu, and Gang Wang , <a href="https://doi.org/10.1007/s00373-015-1643-1">On Computing the Number of Latin Rectangles</a>, Graphs and Combinatorics (2016) 32:1187-1202; DOI 10.1007/s00373-015-1643-1.
%H A000166 Xinyu Sun, <a href="https://cs.uwaterloo.ca/journals/JIS/VOL6/Sun/sun.html">New Lower Bound On The Number of Ternary Square-Free Words</a>, J. Integer Seqs., Vol. 6, 2003.
%H A000166 Lajos Takács, <a href="https://doi.org/10.1007/BF00327875">The Problem of Coincidences</a>, Archive for History of Exact Sciences, Volume 21, No. 3, Sept. 1980. pp. 229-244, paragraph 3.
%H A000166 Raimundas Vidunas, <a href="https://arxiv.org/abs/1401.5400">MacMahon's master theorem and totally mixed Nash equilibria</a>, arXiv:1401.5400 [math.CO], 2014, see (7).
%H A000166 Gérard Villemin's Almanach of Numbers, <a href="http://villemin.gerard.free.fr/Wwwgvmm/Compter/Factsous.htm">Sous-factorielle</a>.
%H A000166 Chenying Wang, Piotr Miska, and István Mezo, <a href="https://doi.org/10.1016/j.disc.2016.10.012">The r-derangement numbers</a>, Discrete Mathematics 340.7 (2017): 1681-1692.
%H A000166 Yi Wang and Bao-Xuan Zhu, <a href="https://arxiv.org/abs/1303.5595">Proofs of some conjectures on monotonicity of number-theoretic and combinatorial sequences</a>, arXiv preprint arXiv:1303.5595 [math.CO], 2013.
%H A000166 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/CrownGraph.html">Crown Graph</a>.
%H A000166 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/Derangement.html">Derangement</a>.
%H A000166 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/EdgeCover.html">Edge Cover</a>.
%H A000166 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/ExponentialDistribution.html">Exponential Distribution</a>.
%H A000166 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/Matching.html">Matching</a>.
%H A000166 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/MaximumIndependentEdgeSet.html">Maximum Independent Edge Set</a>.
%H A000166 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/RooksProblem.html">Rooks Problem</a>.
%H A000166 Eric Weisstein's World of Mathematics, <a href="https://mathworld.wolfram.com/Subfactorial.html">Subfactorial</a>.
%H A000166 Wikipedia, <a href="http://en.wikipedia.org/wiki/Derangement">Derangement</a>.
%H A000166 Wikipedia, <a href="http://en.wikipedia.org/wiki/Rencontres_numbers">Rencontres numbers</a>.
%H A000166 Herbert S. Wilf, <a href="https://www.jstor.org/stable/2690295">A bijection in the theory of derangements</a>, Mathematics Magazine, 57(1):37-40, 1984.
%H A000166 Herbert S. Wilf, <a href="http://www.math.upenn.edu/~wilf/DownldGF.html">Generatingfunctionology</a>, 2nd edn., Academic Press, NY, 1994, p. 176, Eq. 5.2.9 (q=1).
%H A000166 E. M. Wright, <a href="http://jlms.oxfordjournals.org/content/s2-4/3/437.extract">Arithmetical properties of Euler's rencontre number</a>, J. London Math. Soc., (2) (1971/1972), 437-442.
%H A000166 Doron Zeilberger, <a href="https://arxiv.org/abs/1401.1089">Automatic Enumeration of Generalized Menage Numbers</a>, arXiv:1401.1089 [math.CO], 2014.
%H A000166 OEIS Wiki, <a href="/wiki/Derangement_numbers">Derangement numbers</a>.
%H A000166 OEIS Wiki, <a href="/wiki/Rencontres_numbers">Rencontres numbers</a>.
%H A000166 <a href="/index/Cor#core">Index entries for "core" sequences</a>.
%H A000166 <a href="/index/Mat#binmat">Index entries for sequences related to binary matrices</a>.
%F A000166 (A000166 + A000522)/2 = A009179, (A000166 - A000522)/2 = A009628.
%F A000166 a(n) = A008290(n,0).
%F A000166 a(n) + A003048(n+1) = 2*n!. - D. G. Rogers, Aug 26 2006
%F A000166 a(n) = {(n-1)!/exp(1)}, n > 1, where {x} is the nearest integer function. - _Simon Plouffe_, March 1993 [This uses offset 1, see below for the version with offset 0. - _Charles R Greathouse IV_, Jan 25 2012]
%F A000166 a(0) = 1, a(n) = round(n!/e) = floor(n!/e + 1/2) for n > 0.
%F A000166 a(n) = n!*Sum_{k=0..n} (-1)^k/k!.
%F A000166 D-finite with recurrence a(n) = (n-1)*(a(n-1) + a(n-2)), n > 0.
%F A000166 a(n) = n*a(n-1) + (-1)^n.
%F A000166 E.g.f.: exp(-x)/(1-x).
%F A000166 a(n) = Sum_{k=0..n} binomial(n, k)*(-1)^(n-k)*k! = Sum_{k=0..n} (-1)^(n-k)*n!/(n-k)!. - _Paul Barry_, Aug 26 2004
%F A000166 The e.g.f. y(x) satisfies y' = x*y/(1-x).
%F A000166 Inverse binomial transform of A000142. - _Ross La Haye_, Sep 21 2004
%F A000166 In Maple notation, representation as n-th moment of a positive function on [-1, infinity]: a(n)= int( x^n*exp(-x-1), x=-1..infinity ), n=0, 1... . a(n) is the Hamburger moment of the function exp(-1-x)*Heaviside(x+1). - _Karol A. Penson_, Jan 21 2005
%F A000166 a(n) = A001120(n) - n!. - _Philippe Deléham_, Sep 04 2005
%F A000166 a(n) = Integral_{x=0..oo} (x-1)^n*exp(-x) dx. - _Gerald McGarvey_, Oct 14 2006
%F A000166 a(n) = Sum_{k=2,4,...} T(n,k), where T(n,k) = A092582(n,k) = k*n!/(k+1)! for 1 <= k < n and T(n,n)=1. - _Emeric Deutsch_, Feb 23 2008
%F A000166 a(n) = n!/e + (-1)^n*(1/(n+2 - 1/(n+3 - 2/(n+4 - 3/(n+5 - ...))))). Asymptotic result (Ramanujan): (-1)^n*(a(n) - n!/e) ~ 1/n - 2/n^2 + 5/n^3 - 15/n^4 + ..., where the sequence [1,2,5,15,...] is the sequence of Bell numbers A000110. - _Peter Bala_, Jul 14 2008
%F A000166 From William Vaughn (wvaughn(AT)cvs.rochester.edu), Apr 13 2009: (Start)
%F A000166 a(n) = Integral_{p=0..1} (log(1/(1-p)) - 1)^n dp.
%F A000166 Proof: Using the substitutions 1=log(e) and y = e(1-p) the above integral can be converted to ((-1)^n/e) Integral_{y=0..e} (log(y))^n dy.
%F A000166 From CRC Integral tables we find the antiderivative of (log(y))^n is (-1)^n n! Sum_{k=0..n} (-1)^k y(log(y))^k / k!.
%F A000166 Using the fact that e(log(e))^r = e for any r >= 0 and 0(log(0))^r = 0 for any r >= 0 the integral becomes n! * Sum_{k=0..n} (-1)^k / k!, which is line 9 of the Formula section. (End)
%F A000166 a(n) = exp(-1)*Gamma(n+1,-1) (incomplete Gamma function). - _Mark van Hoeij_, Nov 11 2009
%F A000166 G.f.: 1/(1-x^2/(1-2x-4x^2/(1-4x-9x^2/(1-6x-16x^2/(1-8x-25x^2/(1-... (continued fraction). - _Paul Barry_, Nov 27 2009
%F A000166 a(n) = Sum_{p in Pano1(n)} M2(p), n >= 1, with Pano1(n) the set of partitions without part 1, and the multinomial M2 numbers. See the characteristic array for partitions without part 1 given by A145573 in Abramowitz-Stegun (A-S) order, with A002865(n) the total number of such partitions. The M2 numbers are given for each partition in A-St order by the array A036039. - _Wolfdieter Lang_, Jun 01 2010
%F A000166 a(n) = row sum of A008306(n), n > 1. - _Gary Detlefs_, Jul 14 2010
%F A000166 a(n) = ((-1)^n)*(n-1)*hypergeom([-n+2, 2], [], 1), n>=1; 1 for n=0. - _Wolfdieter Lang_, Aug 16 2010
%F A000166 a(n) = (-1)^n * hypergeom([ -n, 1], [], 1), n>=1; 1 for n=0. From the binomial convolution due to the e.g.f. - _Wolfdieter Lang_, Aug 26 2010
%F A000166 Integral_{x=0..1} x^n*exp(x) = (-1)^n*(a(n)*e - n!).
%F A000166 O.g.f.: Sum_{n>=0} n^n*x^n/(1 + (n+1)*x)^(n+1). - _Paul D. Hanna_, Oct 06 2011
%F A000166 Abs((a(n) + a(n-1))*e - (A000142(n) + A000142(n-1))) < 2/n. - _Seiichi Kirikami_, Oct 17 2011
%F A000166 G.f.: hypergeom([1,1],[],x/(x+1))/(x+1). - _Mark van Hoeij_, Nov 07 2011
%F A000166 From _Sergei N. Gladkovskii_, Nov 25 2011, Jul 05 2012, Sep 23 2012, Oct 13 2012, Mar 09 2013, Mar 10 2013, Oct 18 2013: (Start)
%F A000166 Continued fractions:
%F A000166 In general, e.g.f. (1+a*x)/exp(b*x) = U(0) with U(k) = 1 + a*x/(1-b/(b-a*(k+1)/U(k+1))). For a=-1, b=-1: exp(-x)/(1-x) = 1/U(0).
%F A000166 E.g.f.: (1-x/(U(0)+x))/(1-x), where U(k) = k+1 - x + (k+1)*x/U(k+1).
%F A000166 E.g.f.: 1/Q(0) where Q(k) = 1 - x/(1 - 1/(1 - (k+1)/Q(k+1))).
%F A000166 G.f.: 1/U(0) where U(k) = 1 + x - x*(k+1)/(1 - x*(k+1)/U(k+1)).
%F A000166 G.f.: Q(0)/(1+x) where Q(k) = 1 + (2*k+1)*x/((1+x)-2*x*(1+x)*(k+1)/(2*x*(k+1)+(1+x)/ Q(k+1))).
%F A000166 G.f.: 1/Q(0) where Q(k) = 1 - 2*k*x - x^2*(k + 1)^2/Q(k+1).
%F A000166 G.f.: T(0) where T(k) = 1 - x^2*(k+1)^2/(x^2*(k+1)^2-(1-2*x*k)*(1-2*x-2*x*k)/T(k+1)). (End)
%F A000166 0 = a(n)*(a(n+1) + a(n+2) - a(n+3)) + a(n+1)*(a(n+1) + 2*a(n+2) - a(n+3)) + a(n+2)*a(n+2) if n>=0. - _Michael Somos_, Jan 25 2014
%F A000166 a(n) = Sum_{k = 0..n} (-1)^(n-k)*binomial(n,k)*(k + x)^k*(k + x + 1)^(n-k) = Sum_{k = 0..n} (-1)^(n-k)*binomial(n,k)*(k + x)^(n-k)*(k + x - 1)^k, for arbitrary x. - _Peter Bala_, Feb 19 2017
%F A000166 From _Peter Luschny_, Jun 20 2017: (Start)
%F A000166 a(n) = Sum_{j=0..n} Sum_{k=0..n} binomial(-j-1, -n-1)*abs(Stirling1(j, k)).
%F A000166 a(n) = Sum_{k=0..n} (-1)^(n-k)*Pochhammer(n-k+1, k) (cf. A008279). (End)
%F A000166 a(n) = n! - Sum_{j=0..n-1} binomial(n,j) * a(j). - _Alois P. Heinz_, Jan 23 2019
%F A000166 Sum_{n>=2} 1/a(n) = A281682. - _Amiram Eldar_, Nov 09 2020
%F A000166 a(n) = KummerU(-n, -n, -1). - _Peter Luschny_, May 10 2022
%F A000166 a(n) = (-1)^n*Sum_{k=0..n} Bell(k)*Stirling1(n+1, k+1). - _Mélika Tebni_, Jul 05 2022
%e A000166 a(2) = 1, a(3) = 2 and a(4) = 9 since the possibilities are {BA}, {BCA, CAB} and {BADC, BCDA, BDAC, CADB, CDAB, CDBA, DABC, DCAB, DCBA}. - _Henry Bottomley_, Jan 17 2001
%e A000166 The Boolean complex of the complete graph K_4 is homotopy equivalent to the wedge of 9 3-spheres.
%e A000166 Necklace problem for n = 6: partitions without part 1 and M2 numbers for n = 6: there are A002865(6) = 4 such partitions, namely (6), (2,4), (3^2) and (2^3) in A-St order with the M2 numbers 5!, 90, 40 and 15, respectively, adding up to 265 = a(6). This corresponds to 1 necklace with 6 beads, two necklaces with 2 and 4 beads respectively, two necklaces with 3 beads each and three necklaces with 2 beads each. - _Wolfdieter Lang_, Jun 01 2010
%e A000166 G.f. = 1 + x^2 + 9*x^3 + 44*x^4 + 265*x^5 + 1854*x^6 + 14833*x^7 + 133496*x^8 + ...
%p A000166 A000166 := proc(n) option remember; if n<=1 then 1-n else (n-1)*(procname(n-1)+procname(n-2)); fi; end;
%p A000166 a:=n->n!*sum((-1)^k/k!, k=0..n): seq(a(n), n=0..21); # _Zerinvary Lajos_, May 17 2007
%p A000166 ZL1:=[S,{S=Set(Cycle(Z,card>1))},labeled]: seq(count(ZL1,size=n),n=0..21); # _Zerinvary Lajos_, Sep 26 2007
%p A000166 with (combstruct):a:=proc(m) [ZL,{ZL=Set(Cycle(Z,card>=m))},labeled]; end: A000166:=a(2):seq(count(A000166,size=n),n=0..21); # _Zerinvary Lajos_, Oct 02 2007
%p A000166 Z := (x, m)->m!^2*sum(x^j/((m-j)!^2), j=0..m): R := (x, n, m)->Z(x, m)^n: f := (t, n, m)->sum(coeff(R(x, n, m), x, j)*(t-1)^j*(n*m-j)!, j=0..n*m): seq(f(0, n, 1), n=0..21); # _Zerinvary Lajos_, Jan 22 2008
%p A000166 a:=proc(n) if `mod`(n,2)=1 then sum(2*k*factorial(n)/factorial(2*k+1), k=1.. floor((1/2)*n)) else 1+sum(2*k*factorial(n)/factorial(2*k+1), k=1..floor((1/2)*n)-1) end if end proc: seq(a(n),n=0..20); # _Emeric Deutsch_, Feb 23 2008
%p A000166 G(x):=2*exp(-x)/(1-x): f[0]:=G(x): for n from 1 to 26 do f[n]:=diff(f[n-1],x) od: x:=0: seq(f[n]/2,n=0..21); # _Zerinvary Lajos_, Apr 03 2009
%p A000166 seq(simplify(KummerU(-n, -n, -1)), n = 0..23); # _Peter Luschny_, May 10 2022
%t A000166 a[0] = 1; a[n_] := n*a[n - 1] + (-1)^n; a /@ Range[0, 21] (* _Robert G. Wilson v_ *)
%t A000166 a[0] = 1; a[1] = 0; a[n_] := Round[n!/E] /; n >= 1 (* _Michael Taktikos_, May 26 2006 *)
%t A000166 Range[0, 20]! CoefficientList[ Series[ Exp[ -x]/(1 - x), {x, 0, 20}], x]
%t A000166 dr[{n_,a1_,a2_}]:={n+1,a2,n(a1+a2)}; Transpose[NestList[dr,{0,0,1},30]][[3]] (* _Harvey P. Dale_, Feb 23 2013 *)
%t A000166 a[n_] := (-1)^n HypergeometricPFQ[{- n, 1}, {}, 1]; (* _Michael Somos_, Jun 01 2013 *)
%t A000166 a[n_] := n! SeriesCoefficient[Exp[-x] /(1 - x), {x, 0, n}]; (* _Michael Somos_, Jun 01 2013 *)
%t A000166 Table[Subfactorial[n], {n, 0, 21}] (* _Jean-François Alcover_, Jan 10 2014 *)
%t A000166 RecurrenceTable[{a[n] == n*a[n - 1] + (-1)^n, a[0] == 1}, a, {n, 0, 23}] (* _Ray Chandler_, Jul 30 2015 *)
%t A000166 Subfactorial[Range[0, 20]] (* _Eric W. Weisstein_, Dec 31 2017 *)
%t A000166 nxt[{n_,a_}]:={n+1,a(n+1)+(-1)^(n+1)}; NestList[nxt,{0,1},25][[All,2]] (* _Harvey P. Dale_, Jun 01 2019 *)
%o A000166 (PARI) {a(n) = if( n<1, 1, n * a(n-1) + (-1)^n)}; /* _Michael Somos_, Mar 24 2003 */
%o A000166 (PARI) {a(n) = n! * polcoeff( exp(-x + x * O(x^n)) / (1 - x), n)}; /* _Michael Somos_, Mar 24 2003 */
%o A000166 (PARI) {a(n)=polcoeff(sum(m=0,n,m^m*x^m/(1+(m+1)*x+x*O(x^n))^(m+1)),n)} /* _Paul D. Hanna_ */
%o A000166 (PARI) A000166=n->n!*sum(k=0,n,(-1)^k/k!) \\ _M. F. Hasler_, Jan 26 2012
%o A000166 (PARI) a(n)=if(n,round(n!/exp(1)),1) \\ _Charles R Greathouse IV_, Jun 17 2012
%o A000166 (PARI) apply( {A000166(n)=n!\/exp(n>0)}, [0..22]) \\ _M. F. Hasler_, Nov 09 2024
%o A000166 (Python) See Hobson link.
%o A000166 (Maxima)
%o A000166 s[0]:1$
%o A000166 s[n]:=n*s[n-1]+(-1)^n$
%o A000166 makelist(s[n],n,0,12); /* _Emanuele Munarini_, Mar 01 2011 */
%o A000166 (Haskell)
%o A000166 a000166 n = a000166_list !! n
%o A000166 a000166_list = 1 : 0 : zipWith (*) [1..]
%o A000166                        (zipWith (+) a000166_list $ tail a000166_list)
%o A000166 -- _Reinhard Zumkeller_, Dec 09 2012
%o A000166 (Python)
%o A000166 A000166_list, m, x = [], 1, 1
%o A000166 for n in range(10*2):
%o A000166     x, m = x*n + m, -m
%o A000166     A000166_list.append(x) # _Chai Wah Wu_, Nov 03 2014
%o A000166 (Magma) I:=[0,1]; [1] cat [n le 2 select I[n] else (n-1)*(Self(n-1)+Self(n-2)): n in [1..30]]; // _Vincenzo Librandi_, Jan 07 2016
%Y A000166 Cf. A000142, A002467, A003221, A000522, A000240, A000387, A000449, A000475, A129135, A092582, A000255, A002469, A159610, A068985, A068996, A047865, A038205, A008279, A281682.
%Y A000166 For the probabilities a(n)/n!, see A053557/A053556 and A103816/A053556.
%Y A000166 A diagonal of A008291 and A068106. Column A008290(n,0).
%Y A000166 A001120 has a similar recurrence.
%Y A000166 For other derangement numbers see also A053871, A033030, A088991, A088992.
%Y A000166 Pairwise sums of A002741 and A000757. Differences of A001277.
%Y A000166 Cf. A101560, A101559, A000110, A101033, A101032, A000204, A100492, A099731, A000045, A094216, A094638, A000108.
%Y A000166 A diagonal in triangles A008305 and A010027.
%Y A000166 a(n)/n! = A053557/A053556 = (N(n, n) of A103361)/(D(n, n) of A103360).
%Y A000166 Column k=0 of A086764 and of A334715. Column k=1 of A364068.
%Y A000166 Row sums of A216963 and of A323671.
%K A000166 core,nonn,easy,nice,changed
%O A000166 0,4
%A A000166 _N. J. A. Sloane_
%E A000166 Minor edits by _M. F. Hasler_, Jan 16 2017
