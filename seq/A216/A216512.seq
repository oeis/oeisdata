%I A216512 #28 Nov 24 2025 22:12:33
%S A216512 1,0,0,1,0,0,1,1,1,0,1,0,0,0,0,2,0,0,0,0,0,0,1,0,1,0,0,1,1,0,0,2,0,0,
%T A216512 0,1,1,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,0,0,1,3,0,0,1,0,
%U A216512 0,0,1,1,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,2
%N A216512 Number of nonnegative integer solutions to the equation a^2 + 7*b^2 = n.
%H A216512 Andrew Howroyd, <a href="/A216512/b216512.txt">Table of n, a(n) for n = 1..10000</a>
%H A216512 Aung Phone Maw, <a href="https://arxiv.org/abs/2408.01763">Certain products of sums of Lambert series</a>, arXiv:2408.01763 [math.GM], 2024 (see Corollary 5).
%e A216512 a(8) = 1 since 8 = 1^2 + 7*1^2.
%e A216512 a(11) = 1 since 11 = 2^2 + 7*1^2.
%e A216512 a(88) = 2 since 88 = 9^2 + 7*1^2 = 5^2 + 7*3^2.
%t A216512 r[n_] := Reduce[x >= 0 && y >= 0 && x^2 + 7 y^2 == n, Integers];
%t A216512 a[n_] := Which[rn = r[n]; rn === False, 0, Head[rn] === And, 1, Head[rn] === Or, Length[rn], True, -1];
%t A216512 Table[a[n], {n, 1, 87}] (* _Jean-Fran√ßois Alcover_, Jun 24 2017 *)
%o A216512 (PARI) a(n)=sum(i=0, sqrtint(n\7), issquare(n-7*i^2)) \\ _Andrew Howroyd_, Nov 24 2025
%o A216512 (PARI) \\ solution based on multiplicative A110399.
%o A216512 a(n) = {my(f= factor(n)); (prod(k=1, #f~, my([p, e] = f[k, ]); if( p==2, e-1,  p==7, 1, kronecker(-7, p)==-1, (1+(-1)^e)/2, e+1)) + issquare(n) + issquare(7*n))/2 }; \\ _Andrew Howroyd_, Nov 24 2025
%Y A216512 Cf. A020670, A033719 (all integer solutions), A110399.
%K A216512 nonn,changed
%O A216512 1,16
%A A216512 _V. Raman_, Sep 08 2012
