%I A057689 #37 Feb 14 2026 18:32:09
%S A057689 16,66,50,672,20372,494,36918,1404,12210,4248,5070,1682,1850,2210,
%T A057689 35882,102720,94484303672,30084,178992,5330,246560,6890,294253314,
%U A057689 8416400,515202,134004,2810784,2810883506682183650,377198408,320168,3742442930913284,257150
%N A057689 Maximal term in trajectory of P under the 'Px+1' map, where P = n-th prime, or -1 if no such term exists.
%C A057689 The 'Px+1' map is: x -> (x/p if p = least prime factor(x) < P, else P*x + 1).
%H A057689 Michael S. Branicky, <a href="/A057689/b057689.txt">Table of n, a(n) for n = 2..10001</a> (terms 2..1000 from T. D. Noe)
%e A057689 For n=3, P=7: trajectory of 7 is 7, 50, 25, 5, 1, 8, 4, 2, 1, 8, 4, 2, 1, 8, 4, 2, 1, ..., which has maximal term 50, cycle length 4 and there are 4 terms before it enters the cycle.
%t A057689 Px1[p_,n_]:=Catch[For[i=1,i<PrimePi[p],i++,If[Divisible[n,Prime[i]],Throw[n/Prime[i]]]];p*n+1];
%t A057689 With[{nmax=50},Table[Max[NestWhileList[Px1[Prime[n],#]&,Prime[n],UnsameQ,All]],{n,2,nmax}]] (* _Paolo Xausa_, Dec 11 2023 *)
%o A057689 (Python)
%o A057689 from sympy import prime, primerange
%o A057689 def a(n):
%o A057689     P = prime(n)
%o A057689     x, plst, seen = P, list(primerange(2, P)), set()
%o A057689     while x > 1 and x not in seen:
%o A057689         seen.add(x)
%o A057689         x = next((x//p for p in plst if x%p == 0), P*x+1)
%o A057689     return max(seen)
%o A057689 print([a(n) for n in range(2, 32)]) # _Michael S. Branicky_, Dec 11 2023
%o A057689 (PARI) apply( {A057689(n)=my(m=oo, p=n=prime(n), M=n); until(n==m, if(n<m, m=n, n>M, M=n); forprime(q=2, p-1, if(n%q==0, n\=q; next(2))); n=n*p+1); M}, [2..33]) \\ M. F. Hasler, Feb 13 2026
%Y A057689 Cf. A057690, A057691 (cycle and transition length for Px+1).
%Y A057689 Cf. A033478, A057688, A057684, A057685, A057686, A057687 (trajectory of P under Px+1 for P = 3, 5, 13, 19, 23, 29).
%Y A057689 Cf. A057614, A057522, A057446, A057534, A057216 (other trajectories under 11x+1, 13x+1 and 17x+1).
%Y A057689 Cf. A020639 (least prime factor).
%K A057689 nonn,nice,changed
%O A057689 2,1
%A A057689 _N. J. A. Sloane_, Oct 20 2000
%E A057689 More terms from Larry Reeves (larryr(AT)acm.org), Nov 08 2000
