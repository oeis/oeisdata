%I A357301 #26 Dec 08 2025 08:59:06
%S A357301 0,1,7,19,48,112,212,383,641,988,1523,2250,3103,4364,5831,7696,9985,
%T A357301 12945,16164,20246,24946,30145,36385,43839,51752,61610,72475,84273,
%U A357301 97231,112733,129111,148178,168585,190609,215549,242392,270459,303510,338324,375848,416522
%N A357301 a(n) is the number of distinct radii of circles passing through at least three points in a square grid of n X n points.
%C A357301 Proposed by _Ed Pegg Jr_ in Mathematics StackExchange question 273348, where terms up to 212 were given, see link.
%H A357301 Chai Wah Wu, <a href="/A357301/b357301.txt">Table of n, a(n) for n = 1..93</a>
%H A357301 Mathematics StackExchange, <a href="https://math.stackexchange.com/questions/273348/number-of-circles-in-configuration">Number of circles in configuration</a>, comment by Ed Pegg, Jan 09, 2013.
%e A357301 a(2) = 1: only one possible circle with squared radius 1/2;
%e A357301 a(3) = 7: squared radii of possible circles are {1, 2, 1/2, 5/2, 5/4, 25/16, 25/18}.
%o A357301 (PARI) \\ Function r2 determined using Mathematica
%o A357301 \\ (ArcLength [CircleThrough[{{x1, y1}, {x2, y2}, {x3, y3}}]]/(2*Pi))^2
%o A357301 radii(n) = {my (R=List(), r2(x1,y1,x2,y2,x3,y3) = ((x3 + (x2^2*y1 - x3^2*y1 - x1^2*y2 + x3^2*y2 - y1^2*y2 + y1*y2^2 + x1^2*y3 - x2^2*y3 + y1^2*y3 - y2^2*y3 - y1*y3^2 + y2*y3^2)/(2*(-x2*y1 + x3*y1 + x1*y2 - x3*y2 - x1*y3 + x2*y3)))^2 + (y3 - (-2*(x2 - x3)*(x1^2 - x3^2 + y1^2 - y3^2) + 2*(x1 - x3)*(x2^2 - x3^2 + y2^2 - y3^2))/(-4*x2*y1 + 4*x3*y1 + 4*x1*y2 - 4*x3*y2 - 4*x1*y3 + 4*x2*y3))^2)); for(x1=1, n, for(y1=1, n, for(x2=1, x1, for(y2=1, n, for(x3=1, x2, for(y3=1, n,
%o A357301 my (ax2=2*(x2-x1), ay2=2*(y2-y1), ax3=2*(x3-x1), ay3=2*(y3-y1), den=ax2*ay3 -ax3*ay2); if (den==0, next); listput (R, r2(x1,y1,x2,y2,x3,y3)))))))); Set(R)};
%o A357301 for (k=1,15, print1(#radii(k),", "))
%o A357301 (Python)
%o A357301 # after _Hugo Pfoertner_'s PARI code
%o A357301 from math import gcd
%o A357301 from itertools import product
%o A357301 from sympy.utilities.iterables import combinations_with_replacement
%o A357301 def A357301(n):
%o A357301     c, t = set(), 0
%o A357301     for x1,x2,x3 in combinations_with_replacement(range(1,n+1),3):
%o A357301         for y1,y2,y3 in product(range(1,n+1),repeat=3):
%o A357301             den = (x1-x2)*(y1-y3)-(x1-x3)*(y1-y2)<<2
%o A357301             if den:
%o A357301                 x = ((x1-x2)**2+(y1-y2)**2)*((x1-x3)**2+(y1-y3)**2)*((x2-x3)**2+(y2-y3)**2)
%o A357301                 y = (x1*(y2-y3)-x2*(y1-y3)+x3*(y1-y2))**2<<2
%o A357301                 gc = gcd(x,y)
%o A357301                 x //= gc
%o A357301                 y //= gc
%o A357301                 if (r:=(x,y)) not in c:
%o A357301                     c.add(r)
%o A357301                     t += 1
%o A357301     return t # _Chai Wah Wu_, Nov 30 2025
%Y A357301 Cf. A192493, A192494, A355884.
%K A357301 nonn,changed
%O A357301 1,3
%A A357301 _Hugo Pfoertner_, Sep 23 2022, following a suggestion by _Ed Pegg Jr_, Jan 09 2013
%E A357301 a(31)-a(41) from _Chai Wah Wu_, Nov 30 2025
