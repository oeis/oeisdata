%I A215454 #27 Feb 27 2026 14:29:42
%S A215454 1,4,6,6,10,6,14,8,9,10,22,6,26,14,10,10,34,9,38,10,14,22,46,8,20,26,
%T A215454 15,14,58,10,62,12,22,34,14,9,74,38,26,10,82,14,86,22,10,46,94,10,28,
%U A215454 20,34,26,106,15,22,14,38,58,118,10,122,62,14,16,26,22,134,34
%N A215454 a(n) = least positive k such that n^2 divides k!
%C A215454 Indices n such that a(n)=n: 1 followed by A074845.
%H A215454 Vincenzo Librandi, <a href="/A215454/b215454.txt">Table of n, a(n) for n = 1..10000</a>
%F A215454 a(n) = A002034(n^2). - _Chai Wah Wu_, Feb 26 2026
%e A215454 a(12): least positive k such that 144 divides k! is k=6, 6!=720. So a(12)=6.
%t A215454 Module[{nn=200,f},f=Range[nn]!;Position[f,#]&/@Table[SelectFirst[ f, Divisible[ #,n^2]&],{n,nn}]]//Flatten (* Requires Mathematica version 10 or later *) (* _Harvey P. Dale_, Dec 11 2018 *)
%t A215454 ClearAll[a];a[n_Integer? Positive]:=If[n==1,1,Max@Table[Module[{p=f[[i,1]],e=f[[i,2]],k=0,s=0,q},While[s<2 e,k++;s=0;q=k; While[q>0,q=Quotient[q,p];s+=q];]; k],{i,Length[f=FactorInteger[n]]}]]; Table[a[n],{n,1,80}] (* _Vincenzo Librandi_, Feb 26 2026 *)
%o A215454 (Python)
%o A215454 TOP = 77
%o A215454 ii = [0]*TOP
%o A215454 for i in range(1, TOP):
%o A215454     ii[i] = i*i
%o A215454 f = k = y = 1
%o A215454 res = [-1]*TOP
%o A215454 while y<TOP:
%o A215454     for i in range(1, TOP):
%o A215454       if res[i]<0 and f % ii[i] == 0:
%o A215454         res[i] = k
%o A215454         y += 1
%o A215454     k += 1
%o A215454     f *= k
%o A215454 for i in range(1, TOP):
%o A215454     print(res[i], end=', ')
%o A215454 (Python)
%o A215454 from itertools import count
%o A215454 from sympy import factorint, multiplicity
%o A215454 def A215454(n):
%o A215454     m = 1
%o A215454     for p, e in factorint(n).items():
%o A215454         g = e<<1
%o A215454         if g<=p:
%o A215454             m = max(m,g*p)
%o A215454         else:
%o A215454             c, a = 0, max(p,(g*(p-1)//p**2)*p)
%o A215454             b = a-p
%o A215454             while b>0:
%o A215454                 c += (b:=b//p)
%o A215454             for k in count(a,p):
%o A215454                 c += multiplicity(p,k) if p>2 else (~k&k-1).bit_length()
%o A215454                 if c+k+p > g:
%o A215454                     m = max(m, p*(max(k,g-c) if g>=p else g+1-c))
%o A215454                     break
%o A215454     return m # _Chai Wah Wu_, Feb 26 2026
%o A215454 (Magma)
%o A215454 vp := function(k,p) s := 0; q := k; while q gt 0 do q := q div p; s +:= q; end while; return s; end function;
%o A215454 a := function(n) if n eq 1 then return 1; end if; F := Factorization(n); M := 0; for i in [1..#F] do p := F[i][1]; e := F[i][2]; k := 0; while vp(k,p) lt 2*e do k +:= 1; end while; if k gt M then M := k; end if; end for; return M; end function;
%o A215454 print [a(n) : n in [1..80]]; // _Vincenzo Librandi_, Feb 26 2026
%Y A215454 Cf. A002034 (least k such that n divides k!).
%Y A215454 Cf. A085779 (least k such that triangular(n) divides k!).
%Y A215454 Cf. A093896 (least positive k such that n^n divides k!).
%K A215454 nonn,changed
%O A215454 1,2
%A A215454 _Alex Ratushnyak_, Aug 11 2012
