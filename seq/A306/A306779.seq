%I A306779 #44 Nov 08 2025 10:37:09
%S A306779 1,2,4,3,5,9,4,8,11,16,5,9,14,19,25,6,12,18,24,29,36,7,13,19,27,33,41,
%T A306779 49,8,16,23,32,38,48,55,64,9,17,27,35,44,54,62,71,81,10,20,29,40,50,
%U A306779 60,69,80,89,100,11,21,32,43,53,65,76,87,97,109,121
%N A306779 Table read by rows: T(n,k) is the length of the longest non-intersecting loop starting at (0,0) on the n X k torus consisting of steps up and to the right, 1 <= k <= n.
%C A306779 Conjecture: T(n,k) = n*k if and only if k = 1 or gcd(n,k) > 1.
%C A306779 Proof from _Fülöp Tamás_, Nov 07 2025: (Start)
%C A306779 T(n, 1) = n*1 trivially.
%C A306779 (=>)
%C A306779 Suppose T(n, k) = n*k, k != 1, and gcd(n, k) = 1,
%C A306779 then 1 <= a <= k, 1 <= b <= n : gcd(a, b) = 1 and a*n+b*k = n*k.
%C A306779 gcd(n, k) = 1 and b*k = n*(k-a) imply k|(k-a), k|(k-a) implies k|a,
%C A306779 k|a and 1 <= a <= k imply a = k, but then b = n*(k-a)/k = 0, contradicting b >= 1.
%C A306779 (<=)
%C A306779 Let d = gcd(n, k) > 1, n = d*u, k = d*v with gcd(u, v) = 1.
%C A306779 Choose 1 <= t <= d-1 using the Chinese remainder theorem
%C A306779 so that t !== d (mod p) for every prime p|v, gcd(t, u) = 1.
%C A306779 Let x = v*t, then n*x/k = u*t implies n*x == 0 (mod k).
%C A306779 k-x = d*v-v*t = v*(d-t), then gcd(k-x, floor(n*x/k)) = gcd(v*(d-t), u*t) = 1.
%C A306779 Using the second formula with the conditions satisfied, we get T(n, k) = n*k. (End)
%H A306779 Fülöp Tamás, <a href="/A306779/b306779.txt">Rows n = 1..100 of triangle, flattened</a>
%F A306779 From _Fülöp Tamás_, Nov 05 2025: (Start)
%F A306779 T(n, k) = max{a*n+b*k : 1 <= a <= k, 1 <= b <= n, a*n+b*k <= n*k, gcd(a, b) = 1}.
%F A306779 T(n, k) = n*k - min{(n*x) mod k : 0 <= x <= k-1, gcd(k-x, floor(n*x/k)) = 1}. (End)
%e A306779 T(8, 5) = 38 = 1*8+6*5, where d = gcd(1, 6) = 1 and the loop visits (0,0) d+1 times. - _Fülöp Tamás_, Nov 05 2025
%e A306779 Table begins:
%e A306779   1;
%e A306779   2,  4;
%e A306779   3,  5,  9;
%e A306779   4,  8, 11, 16;
%e A306779   5,  9, 14, 19, 25;
%e A306779   6, 12, 18, 24, 29, 36;
%o A306779 (Python)
%o A306779 from math import gcd
%o A306779 def T(n, k): return n*k-min((n*x)%k for x in range(k) if gcd(k-x, n*x//k)==1)
%o A306779 print([T(n, k) for n in range(1, 12) for k in range(1, n+1)]) # _Fülöp Tamás_, Nov 05 2025
%Y A306779 Cf. A324603, A324604.
%K A306779 tabl,nonn,easy,walk
%O A306779 1,2
%A A306779 _Peter Kagey_, Mar 09 2019
%E A306779 More terms from _Fülöp Tamás_, Nov 05 2025
