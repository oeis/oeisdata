%I A260848 #29 Nov 05 2025 15:22:29
%S A260848 1,2,1,6,6,1,21,64,36,0,99,559,772,108,0,588,5656,14544,7222,0,0,3829,
%T A260848 56528,246092,277114,34680,0,0,27404,581511,3900698,8180123,3534038,0,
%U A260848 0,0,206543,6020787,58838383,203964446,198551464,22521600,0,0,0
%N A260848 Triangle read by rows: T(n,g) = number of general immersions of a circle with n crossings in a surface of arbitrary genus g (the circle is not oriented, the surface is oriented).
%C A260848 When transposed, displayed as an upper right triangle, the first line g = 0 of the table gives the number of immersions of a circle with n double points in a sphere (spherical curves) starting with n=1, the second line g = 1 gives immersions in a torus, etc.
%C A260848 Row g=0 is A008987 starting with n = 1.
%C A260848 For g > 0 the immersions are understood up to stable geotopy equivalence (the counted curves cannot be immersed in a surface of smaller genus). - _Robert Coquereaux_, Nov 23 2015
%H A260848 R. Coquereaux and J.-B. Zuber, <a href="https://arxiv.org/abs/1507.03163">Maps, immersions and permutations</a>, arXiv:1507.03163 [math.CO], 2015, Table 9.
%e A260848 The transposed triangle starts:
%e A260848 1    2   6   21    99     588      3829      27404            206543
%e A260848      1   6   64   559    5656     56528     581511           6020787
%e A260848          1   36   772   14544    246092    3900698          58838383
%e A260848               0   108    7222    277114    8180123         203964446
%e A260848                     0      0      34680    3534038         198551464
%e A260848                            0          0         0           22521600
%e A260848                                       0         0                  0
%e A260848                                                 0                  0
%o A260848 (Magma) /* Example n := 6 */
%o A260848 n:=6;
%o A260848 n; // n: number of crossings
%o A260848 G:=Sym(2*n);
%o A260848 doubleG := Sym(4*n);
%o A260848 genH:={};
%o A260848 for j in [1..(n-1)] do v := G!(1,2*j+1)(2, 2*j+2); Include(~genH,v) ; end for;
%o A260848 H := PermutationGroup< 2*n |genH>; //  The H=S(n) subgroup of S(2n)
%o A260848 cardH:=#H;
%o A260848 cardH;
%o A260848 rho:=Identity(G); for j in [0..(n-1)] do v := G!(2*j+1, 2*j+2) ; rho := rho*v ; end for;
%o A260848 cycrho := PermutationGroup< 2*n |{rho}>; // The cyclic subgroup Z2 generated by rho (mirroring)
%o A260848 Hcycrho:=sub<G|[H,cycrho]>;  // The subgroup generated by H and cycrho
%o A260848 cardZp:= Factorial(2*n-1);
%o A260848 beta:=G!Append([2..2*n],1); // A typical circular permutation
%o A260848 Cbeta:=Centralizer(G,beta);
%o A260848 bool, rever := IsConjugate(G,beta,beta^(-1));
%o A260848 cycbeta := PermutationGroup< 2*n |{rever}>;
%o A260848 Cbetarev := sub<G|[Cbeta,cycbeta]>;
%o A260848 psifct := function(per);
%o A260848 perinv:=per^(-1);
%o A260848 res:= [IsOdd(j) select (j+1)^per  else j-1 + 2*n : j in [1..2*n] ];
%o A260848 resbis := [IsOdd((j-2*n)^perinv) select  (j-2*n)^perinv +1 +2*n   else ((j-2*n)^perinv -1)^per : j in [2*n+1..4*n] ];
%o A260848 res cat:= resbis;
%o A260848 return doubleG!res;
%o A260848 end function;
%o A260848 numberofcycles := function(per);   ess :=   CycleStructure(per); return &+[ess[i,2]: i in [1..#ess]]; end function;
%o A260848 supernumberofcycles := function(per); return  numberofcycles(psifct(per)) ; end function;
%o A260848 // result given as a list genuslist (n+2-2g)^^multiplicity where g is the genus
%o A260848 // Case UO
%o A260848 dbl, dblsize := DoubleCosetRepresentatives(G,H,Cbetarev); #dblsize;
%o A260848 genuslist := {* supernumberofcycles(beta^(dbl[j]^(-1))) : j in [1..#dblsize] *}; genuslist;
%o A260848 quit;
%o A260848 // _Robert Coquereaux_, Nov 23 2015
%Y A260848 The sum over all genera g for a fixed number n of crossings is given by sequence A260847.
%Y A260848 Cf. A008987, A260285, A260885, A260914.
%K A260848 nonn,tabl,hard
%O A260848 1,2
%A A260848 _Robert Coquereaux_, Aug 01 2015
