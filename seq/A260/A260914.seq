%I A260914 #28 Nov 05 2025 15:22:29
%S A260914 1,2,1,6,5,1,19,45,22,0,76,335,427,56,0,376,3101,7557,3681,0,0,2194,
%T A260914 29415,124919,139438,17398,0,0,14614,295859,1921246,4098975,1768704,0,
%U A260914 0,0,106421,3031458,29479410,102054037,99304511,11262088,0,0,0
%N A260914 Triangle read by rows: T(n,g) = number of general immersions of a circle with n crossings in a surface of arbitrary genus g (the circle is not oriented, the surface is not oriented).
%C A260914 When transposed, displayed as an upper right triangle, the first line g = 0 of the table gives the number of immersions of a circle with n double points in a sphere (spherical curves) starting with n=1, the second line g = 1 gives immersions in a torus, etc.
%C A260914 Row g=0 is A008989 starting with n = 1.
%C A260914 For g > 0 the immersions are understood up to stable geotopy equivalence (the counted curves cannot be immersed in a surface of smaller genus). - _Robert Coquereaux_, Nov 23 2015
%H A260914 Robert Coquereaux and J.-B. Zuber, <a href="https://arxiv.org/abs/1507.03163">Maps, immersions and permutations</a>, arXiv preprint arXiv:1507.03163 [math.CO], 2015-2016. Also J. Knot Theory Ramifications 25, 1650047 (2016), DOI: 10.1142/S0218216516500474
%e A260914 The transposed triangle starts:
%e A260914   1  2  6  19   76   376     2194     14614     106421
%e A260914      1  5  45  335  3101    29415    295859    3031458
%e A260914         1  22  427  7557   124919   1961246   29479410
%e A260914             0   56  3681   139438   4098975  102054037
%e A260914                  0    0     17398   1768704   99394511
%e A260914                       0         0         0   11262088
%e A260914                                 0         0          0
%e A260914                                           0          0
%e A260914                                                      0
%o A260914 (Magma) /* Example n := 6 */
%o A260914 n:=6;
%o A260914 n; // n: number of crossings
%o A260914 G:=Sym(2*n);
%o A260914 doubleG := Sym(4*n);
%o A260914 genH:={};
%o A260914 for j in [1..(n-1)] do v := G!(1,2*j+1)(2, 2*j+2); Include(~genH,v) ; end for;
%o A260914 H := PermutationGroup< 2*n |genH>; //  The H=S(n) subgroup of S(2n)
%o A260914 cardH:=#H;
%o A260914 cardH;
%o A260914 rho:=Identity(G); for j in [0..(n-1)] do v := G!(2*j+1, 2*j+2) ; rho := rho*v ; end for;
%o A260914 cycrho := PermutationGroup< 2*n |{rho}>; // The cyclic subgroup Z2 generated by rho (mirroring)
%o A260914 Hcycrho:=sub<G|[H,cycrho]>;  // The subgroup generated by H and cycrho
%o A260914 cardZp:= Factorial(2*n-1);
%o A260914 beta:=G!Append([2..2*n],1); // A typical circular permutation
%o A260914 Cbeta:=Centralizer(G,beta);
%o A260914 bool, rever := IsConjugate(G,beta,beta^(-1));
%o A260914 cycbeta := PermutationGroup< 2*n |{rever}>;
%o A260914 Cbetarev := sub<G|[Cbeta,cycbeta]>;
%o A260914 psifct := function(per);
%o A260914 perinv:=per^(-1);
%o A260914 res:= [IsOdd(j) select (j+1)^per  else j-1 + 2*n : j in [1..2*n] ];
%o A260914 resbis := [IsOdd((j-2*n)^perinv) select  (j-2*n)^perinv +1 +2*n   else ((j-2*n)^perinv -1)^per : j in [2*n+1..4*n] ];
%o A260914 res cat:= resbis;
%o A260914 return doubleG!res;
%o A260914 end function;
%o A260914 numberofcycles := function(per);   ess :=   CycleStructure(per); return &+[ess[i,2]: i in [1..#ess]]; end function;
%o A260914 supernumberofcycles := function(per); return  numberofcycles(psifct(per)) ; end function;
%o A260914 // result given as a list genuslist (n+2-2g)^^multiplicity where g is the genus
%o A260914 // Case UU
%o A260914 dbl, dblsize := DoubleCosetRepresentatives(G,Hcycrho,Cbetarev); #dblsize;
%o A260914 genuslist := {* supernumberofcycles(beta^(dbl[j]^(-1))) : j in [1..#dblsize] *}; genuslist;
%o A260914 quit;
%o A260914 // _Robert Coquereaux_, Nov 23 2015
%Y A260914 The sum over all genera g for a fixed number n of crossings is given by sequence A260912. Cf. A008989, A260285, A260848, A260885.
%K A260914 nonn,hard,tabl
%O A260914 1,2
%A A260914 _Robert Coquereaux_, Aug 04 2015
