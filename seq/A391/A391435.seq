%I A391435 #11 Dec 12 2025 11:18:14
%S A391435 1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1,2,1,1,2,2,1,1,2,1,2,1,1,1,2,1,2,1,
%T A391435 2,1,1,1,2,2,1,1,2,1,1,2,1,2,1,2,1,2,1,2,1,2,1,1,2,1,1,2,1,2,2,1,1,2,
%U A391435 2,1,2,2,1,2,2,2,1,1,4,1,1,1,1,2,1,1,1,2,2,2,1,1,2,2,1,1,2,1,1,2,1,1,4
%N A391435 Number of elements that square to the identity in the class group of real quadratic field Q(sqrt(k)), k squarefree > 1.
%C A391435 Not to be confused with A317990, which gives the numbers of elements that square to the identity in the *form class groups* of real quadratic fields.
%H A391435 Jianing Song, <a href="/A391435/b391435.txt">Table of n, a(n) for n = 2..10000</a>
%H A391435 Rick L. Shepherd, <a href="http://libres.uncg.edu/ir/uncg/f/Shepherd_uncg_0154M_11099.pdf">Binary quadratic forms and genus theory</a>, Master of Arts Thesis, University of North Carolina at Greensboro, 2013.
%F A391435 For D = A005117(n), we have a(n) = 2^(A317992(n) - 1) if D has a prime factor congruent to 3 modulo 4, A317992(n) otherwise. (See A391439 for a proof). Note that
%F A391435 - A317992(n) = omega(A005117(n)) - 1 if A005117(n) == 1 (mod 4);
%F A391435 - A317992(n) = omega(4*A005117(n)) - 1 = omega(A005117(n)) - 1 if A005117(n) == 2 (mod 4);
%F A391435 - A317992(n) = omega(4*A005117(n)) - 1 = omega(A005117(n)) if A005117(n) == 3 (mod 4).
%o A391435 (PARI) r(D) = my(w = omega(D) - 1); my(f = factor(D)[, 1]~); for(i=1, #f, if(f[i]%4==3, return(w-1))); return(w) \\ gives 2-rank of Cl(D) for fundamental D
%o A391435 for(D=1, 200, if(D>1 && issquarefree(D), print1(2^r(D*if(D%4==1, 1, 4)), ", ")))
%Y A391435 Cf. A003643 (for imaginary quadratic fields).
%Y A391435 Sequences related to the class groups of real quadratic fields:
%Y A391435              |           Class groups          |       Form class groups       |
%Y A391435 -------------+---------------------------------+-------------------------------+
%Y A391435  Fundamental | 2-rank: A391436, A391437        | 2-rank: A317991, A317992      |
%Y A391435  disc. only  | # of genera: A391426, this seq. | # of genera: A317989, A317990 |
%Y A391435   (A003658)  | Exponent <= 2: A391417          | Exponent <= 2: A391422        |
%Y A391435 -------------+---------------------------------+-------------------------------+
%Y A391435   All disc.  | 2-rank: A391439                 | 2-rank: A391441               |
%Y A391435   (A079896)  | # of genera: A391438            | # of genera: A391440          |
%Y A391435              | Exponent <= 2: A391419          | exponent <= 2: A390079        |
%K A391435 nonn,new
%O A391435 2,6
%A A391435 _Jianing Song_, Dec 10 2025
