%I A391439 #17 Dec 09 2025 22:06:35
%S A391439 0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,
%T A391439 0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,
%U A391439 0,0,1,1,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,1,0,1,1,0,0,0,1,0,0,1,0,0,1,1,0,0,1,0,1,0,0,1,0,0,1,0,0,0,1,0,1,1,0,0,0,1,0,1,0,0,1,1,0,1,0,0,1,1,1,1,0,0,0,0,0,1,1,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,1,1,1,0,0,0,1,0,1,0,0,1,0,0,0,0,1,0,2
%N A391439 2-rank of the class group of the order of real quadratic fields with discriminant A079896(n).
%C A391439 2-rank of the form class group of discriminant D = A079896(n) quotient by {I,-I}, where I is the principal class. (So I corresponds to the form x^2 - (D/4)*y^2 for 4|D and x^2 - x*y - ((D-1)/4)*y^2 for D == 1 (mod 4), and -I corresponds to the form (D/4)*x^2 - y^2 for 4|D and ((D-1)/4)*x^2 - x*y - y^2 for D == 1 (mod 4)).
%C A391439 Let Cl+(D) and Cl(D) be the narrow class group and the class group of the quadratic order of discriminant D. Then Cl+(D)/Cl(D) = 1 if D < 0 or D > 0 and the fundamental unit has norm -1, C_2 if D > 0 and the fundamental unit has norm 1.
%C A391439 Claim. Suppose that the fundamental unit has norm 1.
%C A391439 (a) If 16|D or D has a prime factor congruent to 3 modulo 4, then Cl+(D) = Cl(D) X C_2;
%C A391439 (b) Otherwise, there exists a subgroup G of Cl+(D) such that Cl+(D) = G X C_{2^(r+1)} and Cl(D) = G X C_{2^r}.
%C A391439 Proof. We prove that -I is not a square in Cl+(D) if 16|D or D has a prime factor congruent to 3 modulo 4, and -I is a square otherwise. ((Thankfully) almost nothing more than factorization properties in Z[i] is used). Let f_0(x,y) = (D/4)*x^2 - y^2 for 4|D and ((D-1)/4)*x^2 - x*y - y^2 for D == 1 (mod 4) be in the class -I.
%C A391439 (a) Assume that 16|D or D has a prime factor congruent to 3 modulo 4. Suppose that f is a form such that f^2 is equivalent to f_0. Take a prime p not dividing D represented by f, which exists by W. E. Briggs link. Then p^2 is represented by f^2 ~ f_0, and thus -p^2 is represented by the principal form, which means that -p^2 is a quadratic residue modulo 4 or a prime congruent to 3 modulo 4, impossible.
%C A391439 (b) Suppose first that 4|D. There exists gcd(r,s) = 1 with odd s such that r^2 + s^2 = D/4. Then f_0 is equivalent to f_0(x+y,r*x+(r+1)*y) = s^2*x^2 + 2*(s^2-2*r)*x*y + (s^2-2*r-1)*y^2. Take f(x,y) = s*x^2 + 2*(s^2-2*r)*x*y + s*(s^2-2*r-1)*y^2, then f is a primitive form since gcd(s,4*r) = 1, and f^2 ~ f_0 by Definition 3.1.4 in Rick L. Shepherd link.
%C A391439 For D == 1 (mod 4), there exists gcd(r,s) = 1 with odd r and even s such that r^2 + s^2 = D. Then f_0 is equivalent to f_0(x+y,((r-1)/2)*x+((r+1)/2)*y) = (s^2/4)*x^2 + (s^2/2-r)*x*y + (s^2/4-r-1)*y^2. Take f(x,y) = (s/2)*x^2 + (s^2/2-r)*x*y + (s/2)*(s^2/4-r-1)*y^2, then f is a primitive form, and f^2 ~ f_0.
%H A391439 W. E. Briggs, <a href="https://doi.org/10.4153/CJM-1954-034-0">An Elementary Proof of a Theorem About the Representation of Primes by Quadratic Forms</a>, Canadian Journal of Mathematics, 1954;6:353-363.
%H A391439 Rick L. Shepherd, <a href="http://libres.uncg.edu/ir/uncg/f/Shepherd_uncg_0154M_11099.pdf">Binary quadratic forms and genus theory</a>, Master of Arts Thesis, University of North Carolina at Greensboro, 2013.
%F A391439 For D = A079896(n), we have a(n) = A391441(n) - 1 if 16|D or D has a prime factor congruent to 3 modulo 4, and a(n) = A391441(n) otherwise. (Note that A391441(n) = omega(|D|) - t, where omega = A001221, and t = 0 if 32|D, t = 2 if D == 4 (mod 16), t = 1 otherwise; see A391441 for more details).
%e A391439 Let D = A079896(23) = 60. It is not divisible by 32 nor congruent to 4 modulo 16, so A391441(23) = omega(60) - 1 = 2. Since 60 has a factor (3) congruent to 3 modulo 4, a(23) = A391441(23) - 1 = 1. Indeed, Cl(60) = C_2.
%e A391439 Let D = A079896(219) = 480. It is divisible by 32, so A391441(219) = omega(480) = 3. Since 480 is divisible by 16 (and it also has a factor (3) congruent to 3 modulo 4), a(219) = A391441(219) - 1 = 2. Indeed, Cl(480) = C_2 X C_2.
%e A391439 Let D = A079896(238) = 520. It is not divisible by 32 nor congruent to 4 modulo 16, so A391441(239) = omega(520) - 1 = 2. Since 520 has no prime factor congruent to 3 modulo 4, a(239) = A391441(239) = 2. Indeed, Cl(520) = C_2 X C_2.
%o A391439 (PARI) r(D) = omega(D) - if(D%32==0, 0, if(D%16==4, 2, 1)) \\ gives 2-rank of Cl+(D)
%o A391439 s(D) = if(D%16==0, return(r(D)-1)); my(f = factor(D)[,1]~); for(i=1, #f, if(f[i]%4==3, return(r(D)-1))); return(r(D)) \\ gives 2-rank of Cl(D)
%o A391439 for(D=1, 1000, if(D%4<=1 && !issquare(D), print1(s(D), ", ")))
%Y A391439 Cf. A319659 (for imaginary quadratic fields).
%Y A391439 Sequences related to the class groups of real quadratic fields:
%Y A391439              |          Class groups         |       Form class groups       |
%Y A391439 -------------+-------------------------------+-------------------------------+
%Y A391439  Fundamental | 2-rank: A391436, A391437      | 2-rank: A317991, A317992      |
%Y A391439  disc. only  | # of genera: A391426, A391435 | # of genera: A317989, A317990 |
%Y A391439   (A003658)  | Exponent <= 2: A391417        | Exponent <= 2: A391422        |
%Y A391439 -------------+-------------------------------+-------------------------------+
%Y A391439   All disc.  | 2-rank: this sequence         | 2-rank: A391441               |
%Y A391439   (A079896)  | # of genera: A391438          | # of genera: A391440          |
%Y A391439              | Exponent <= 2: A391419        | exponent <= 2: A390079        |
%Y A391439 For a list of sequences related to the class numbers of real quadratic fields, see A087048.
%K A391439 nonn,new
%O A391439 1,219
%A A391439 _Jianing Song_, Dec 09 2025
