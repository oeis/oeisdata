%I A391004 #48 Dec 02 2025 05:12:40
%S A391004 5,11,17,19,23,29,41,47,53,59,71,79,83,89,103,107,131,139,149,167,179,
%T A391004 191,197,199,223,227,233,239,251,263,269,271,293,307,311,349,359,367,
%U A391004 379,383,389,419,431,439,449,461,463,467,479,499,503,509,557,569,571,587
%N A391004 Primes p that can be represented as the sum of distinct nontrivial divisors of p + 1.
%C A391004 Nontrivial divisors of n are > 1 and < n (A070824).
%C A391004 Subsequence of A391005 (semiperfect primes).
%C A391004 In many cases p + 1 is a practical number (A005153). In fact in the above list only 349 + 1 and 571 + 1 are not practical numbers.
%H A391004 Peter Luschny, <a href="/A391004/b391004.txt">Table of n, a(n) for n = 1..10000</a>
%H A391004 Peter Luschny, <a href="/A391004/a391004_1.py.txt">Divisor subsets. A Python implementation for A39100[4/6/7]</a>.
%e A391004    p as sum of subset of divisors of p + 1.
%e A391004   --------------------------------------------
%e A391004    5 = 2 +  3;
%e A391004   11 = 2 +  3 +  6;
%e A391004   17 = 2 +  6 +  9;
%e A391004   19 = 4 +  5 + 10;
%e A391004   23 = 3 +  8 + 12;
%e A391004   29 = 3 +  5 +  6 + 15;
%e A391004   41 = 6 + 14 + 21;
%e A391004   47 = 3 +  8 + 12 + 24;
%e A391004   53 = 2 +  6 + 18 + 27;
%e A391004   59 = 4 + 10 + 15 + 30;
%e A391004   71 = 8 +  9 + 18 + 36;
%e A391004   79 = 5 +  8 + 10 + 16 + 40;
%e A391004   499= 4 + 20 + 100 + 125 + 250;
%e A391004 .
%e A391004 347 is not a term, even though it is referenced in A391003, because A391003 does not require the divisors to be nontrivial.
%p A391004 issum:= proc(x,S)
%p A391004   option remember;
%p A391004   local Sp,s;
%p A391004   Sp:= select(`<=`,S,x);
%p A391004   if member(x,Sp) then return true fi;
%p A391004   if convert(Sp,`+`) < x then return false fi;
%p A391004   s:= max(Sp); Sp:= Sp minus {s};
%p A391004   procname(x-s,Sp) or procname(x,Sp)
%p A391004 end proc:  # _Robert Israel_, Dec 01 2025
%p A391004 filter:= proc(n)
%p A391004   local S;
%p A391004   S:= numtheory:-divisors(n+1) minus {1, n+1};
%p A391004   issum(n, S)
%p A391004 end proc:
%p A391004 select(filter, {seq(ithprime(i), i=1..1229)});
%t A391004 Select[Prime[Range[3,100]],MemberQ[Total/@Subsets[Rest[Drop[Divisors[#+1],-1]]],#]&] (* _James C. McMahon_, Dec 01 2025 *)
%o A391004 (SageMath)
%o A391004 def is_A391004(n):
%o A391004     if not is_prime(n): return False
%o A391004     divs = sorted(divisors(n + 1))[:-1]
%o A391004     k = len(divs)
%o A391004     for mask in range(1, 1 << k):
%o A391004         subset = [divs[i] for i in range(k) if mask & (1 << i)]
%o A391004         if sum(subset) == n + 1 and 1 in subset: return True
%o A391004     return False
%o A391004 print([n for n in range(2, 600) if is_A391004(n)])
%o A391004 (PARI) is_a391004(n) = my(m=n+1, s=0, so); if(!isprime(n), return(0)); my(dnt=setminus(divisors(m),[1,m]), dodd=select(x->x%2,dnt), nodd=#dodd, deven=setminus(dnt, dodd), neven=#deven); if(nodd==0, return(0)); forstep(jodd=1, nodd, 2, forsubset([nodd,jodd], sodd, so=sum(k=1, #sodd, dodd[sodd[k]]); if(so==n, return(1)); forsubset(neven, seven, my(ns=#seven); if(ns>0, s = so + sum(k=1, ns, deven[seven[k]])); if(s==n, return(1))))); 0 \\ _Hugo Pfoertner_, Nov 29 2025
%Y A391004 Cf. A000040, A070824, A391005, A391003, A070824, A085498, A085499, A005153.
%K A391004 nonn,new
%O A391004 1,1
%A A391004 _Peter Luschny_, Nov 25 2025
