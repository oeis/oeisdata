%I A391441 #13 Dec 10 2025 10:36:01
%S A391441 0,0,1,0,0,0,1,1,1,0,1,1,0,1,0,1,1,1,0,0,1,1,2,0,1,0,1,1,0,1,1,1,1,1,
%T A391441 1,0,1,1,2,0,0,1,2,1,0,1,0,0,1,2,1,0,1,1,1,1,1,0,2,1,1,0,0,1,1,2,0,2,
%U A391441 1,0,2,2,1,0,1,1,1,0,1,1,1,1,2,0,0,1,1,2,1,1,1,0,1,1,1,2,1,2
%N A391441 2-rank of the form class group of the order of real quadratic fields with discriminant A079896(n).
%C A391441 Let Cl+(D) be the form class group and the class group of the quadratic order of discriminant D. Claim: Cl+(D) has 2-rank omega(|D|) - t, where omega = A001221, and t = 0 if 32|D, t = 2 if D == 4 (mod 16), t = 1 otherwise.
%C A391441 Proof. Each class in Cl+(D) whose square is the identity contains two of the following quadratic forms:
%C A391441   (i) a*x^2 + c*y^2, where a > 0, gcd(a,c) = 1;
%C A391441   (ii) a*x^2 + a*y^2 + c*y^2, where a > 0, gcd(a,c) = 1.
%C A391441 See Section 3.3 of the Rick L. Shepherd link below. The proof assumes that D is fundamental but this is not really needed.
%C A391441 As a result, we only need to count the solutions to
%C A391441   (i) -4*a*c = D, where a > 0, gcd(a,c) = 1;
%C A391441   (ii) a^2 - 4*a*c = D, where a > 0, gcd(a,c) = 1.
%C A391441 Indeed, if r is the 2-rank of Cl+(D) and N is the number of solutions, then N = 2^r * 2 = 2^(r+1).
%C A391441 In (i), a can be any unitary divisor of |D|/4, so the number of solutions to (i) is 2^(omega(|D|/4)) if 4|D, and 0 otherwise.
%C A391441 To find the number of solutions to (ii), write D = 2^e * s, s odd. Note that e = v2(a) + v2(a - 4*c), where v2 is the 2-adic valuation.
%C A391441  - If e = 0, then a can be any unitary divisor of |D|, so the number of solutions is 2^(omega(|D|)).
%C A391441  - If e = 2, then a must be even and c must be odd, and so a == 2 (mod 4). We have {a,a-4*c} == {2,6} (mod 8), so D = a * (a-4*c) == 12 (mod 16), in which case a can be twice any unitary divisor of s. The number of solutions is 2^(omega(s)) = 2^(omega(|D|)) - 1 if D == 12 (mod 16) , and 0 if D == 4 (mod 16).
%C A391441  - Obviously there is no solution if e = 3, since v2(a) + v2(a - 4*c) = 2 if v2(a) = 1 and >= v2(a) + 2 if v2(a) >= 2.
%C A391441  - There is also no solution if e = 4: we must have v2(a) = 2, but then a - 4*c is divisible by 8.
%C A391441  - If e >= 5, then v2(a) = 2 or v2(a) = e-2, and so a can be 4 times any unitary divisor of s or 2^(e-2) times any unitary divisor of s. The number of solutions is 2^(omega(s)) * 2 = 2^(omega(|D|)).
%C A391441 We conclude that the number of solutions to (i), (ii) is
%C A391441  - 2^(omega(|D|)-1) if D == 4 (mod 16);
%C A391441  - 2^(omega(|D|)+1) if 32|D;
%C A391441  - 2^(omega(|D|)) otherwise.
%H A391441 Jianing Song, <a href="/A391441/b391441.txt">Table of n, a(n) for n = 1..10000</a>
%H A391441 Rick L. Shepherd, <a href="http://libres.uncg.edu/ir/uncg/f/Shepherd_uncg_0154M_11099.pdf">Binary quadratic forms and genus theory</a>, Master of Arts Thesis, University of North Carolina at Greensboro, 2013.
%F A391441 For D = A079896(n), a(n) = omega(|D|) - t, where omega = A001221, and t = 0 if 32|D, t = 2 if D == 4 (mod 16), t = 1 otherwise.
%e A391441 Let D = A079896(23) = 60. It is not divisible by 32 nor congruent to 4 modulo 16, so a(23) = omega(60) - 1 = 2. Indeed, Cl+(60) = C_2 X C_2.
%e A391441 Let D = A079896(219) = 480. It is divisible by 32, so a(219) = omega(480) = 3. Indeed, Cl+(480) = C_2 X C_2 X C_2.
%e A391441 Let D = A079896(238) = 520. It is not divisible by 32 nor congruent to 4 modulo 16, so a(238) = omega(520) - 1 = 2. Indeed, Cl+(520) = C_2 X C_2.
%o A391441 (PARI) r(D) = omega(D) - if(D%32==0, 0, if(D%16==4, 2, 1)) \\ gives 2-rank of Cl+(D)
%o A391441 for(D=1, 1000, if(D%4<=1 && !issquare(D), print1(r(D), ", ")))
%Y A391441 Cf. A319659 (for imaginary quadratic fields).
%Y A391441 Sequences related to the class groups of real quadratic fields:
%Y A391441              |          Class groups         |       Form class groups       |
%Y A391441 -------------+-------------------------------+-------------------------------+
%Y A391441  Fundamental | 2-rank: A391436, A391437      | 2-rank: A317991, A317992      |
%Y A391441  disc. only  | # of genera: A391426, A391435 | # of genera: A317989, A317990 |
%Y A391441   (A003658)  | Exponent <= 2: A391417        | Exponent <= 2: A391422        |
%Y A391441 -------------+-------------------------------+-------------------------------+
%Y A391441   All disc.  | 2-rank: A391439               | 2-rank: this sequence         |
%Y A391441   (A079896)  | # of genera: A391438          | # of genera: A391440          |
%Y A391441              | Exponent <= 2: A391419        | exponent <= 2: A390079        |
%Y A391441 For a list of sequences related to the class numbers of real quadratic fields, see A087048.
%K A391441 nonn
%O A391441 1,23
%A A391441 _Jianing Song_, Dec 09 2025
