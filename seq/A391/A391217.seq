%I A391217 #26 Dec 15 2025 21:55:39
%S A391217 1,2,1,3,1,4,2,1,5,1,6,2,1,3,1,7,1,8,2,1,4,1,3,2,1,9,1,10,1,5,2,1,11,
%T A391217 1,3,2,1,4,1,12,1,6,2,1,3,1,13,2,1,14,1,5,2,1,4,1,3,1,7,2,1,15,1,16,2,
%U A391217 1,3,1,8,1,4,2,1,6,1,17,2,1,3,1,5,1,18
%N A391217 Sequence generated by iterative conditional Gauss-Kuzmin probabilities (see Comments).
%C A391217 Construction as described in Bailey et al.:
%C A391217 "First, for the correct Gauss-Kuzmin density of 1's, namely p1 = log2(4/3), generate a list of 0's and 1's by assigning element values a(n) = k*(floor(n*p1) - floor((n-1)*p1)) for n > 0 and k = 1. Now replace the remaining 0's in the sequence with 2's, by replacing p1 with p2/(1 - p1) and incrementing k to 2, in which case the index n on a(n) refers, naturally, to the n-th zero of the preceding list. Continuation of this construction for k = 3, 4, ... gives a real number:
%C A391217 R = [0; 1, 2, 1, 3, 1, 4, 2, 1, 5, 6, 2, 1, 3, 1, 7, 1, 8, 2, 1, 4, 1, 3, 2, 1, 9, 1, ...]."
%C A391217 Bailey et al. posit that the geometric mean of the sequence (interpreted as a simple continued fraction expansion) is Khinchin's constant (A002210).
%H A391217 Jwalin Bhatt, <a href="/A391217/b391217.txt">Table of n, a(n) for n = 1..10000</a>
%H A391217 David H. Bailey, Jonathan M. Borwein, and Richard E. Crandall, <a href="https://www.jstor.org/stable/2153664">On the Khintchine constant</a>, Math. Comput., Vol. 66, No. 217 (January 1997), 417-431.
%e A391217 Example of how the sequence updates as k increments:
%e A391217   k=1 -> [1, 0, 1, 0, 1, 0, 0, 1, 0, 1]
%e A391217   k=2 -> [1, 2, 1, 0, 1, 0, 2, 1, 0, 1]
%e A391217   k=3 -> [1, 2, 1, 3, 1, 0, 2, 1, 0, 1]
%e A391217   k=4 -> [1, 2, 1, 3, 1, 4, 2, 1, 0, 1]
%e A391217   k=5 -> [1, 2, 1, 3, 1, 4, 2, 1, 5, 1]
%o A391217 (Python)
%o A391217 from mpmath import iv
%o A391217 from math import ceil
%o A391217 log2 = iv.log(2)
%o A391217 def iv_ceil(x):
%o A391217     a, b = ceil(x.a), ceil(x.b)
%o A391217     if a!=b: raise ValueError
%o A391217     return a
%o A391217 def sample_gauss_kuzmin_distribution(n):
%o A391217     k, p_sum, seq = 1, 0, [0] * n
%o A391217     zero_idx = list(range(n))
%o A391217     while zero_idx:
%o A391217         pk = -iv.log(1-1/((k+1)*(k+1))) / log2
%o A391217         p_cond = pk / (1 - p_sum)
%o A391217         new_zero_idx = []
%o A391217         for i, seq_i in enumerate(zero_idx, start=1):
%o A391217             val = int(iv_ceil(i*p_cond) - iv_ceil((i-1)*p_cond))
%o A391217             if val: seq[seq_i] = k
%o A391217             else: new_zero_idx.append(seq_i)
%o A391217         zero_idx = new_zero_idx
%o A391217         p_sum += pk
%o A391217         k += 1
%o A391217     return seq
%o A391217 A391217 = sample_gauss_kuzmin_distribution(101)
%Y A391217 Cf. A002210, A072193, A084580, A089618, A241773, A390946.
%K A391217 nonn,new
%O A391217 1,2
%A A391217 _Jwalin Bhatt_, Dec 04 2025
