%I A391161 #9 Dec 12 2025 11:40:12
%S A391161 1,0,1,6,0,4,2463,252,0,129,168710720,2360896,98560,0,43968,
%T A391161 2463965471530395,3853366387000,18229845000,474718605,0,254429900,
%U A391161 14314557500958748403432016,1835239210644761036784,775664270273023776,1904255124528024,39627683503488,0,30468670170912
%N A391161 Triangle read by rows: T(n,k) is the number of nonisomorphic magmas with n elements and a closed center of size k.
%H A391161 Andrew Howroyd, <a href="/A391161/b391161.txt">Table of n, a(n) for n = 0..324</a> (rows 0..24)
%e A391161 Triangle begins:
%e A391161           1;
%e A391161           0,       1;
%e A391161           6,       0,     4;
%e A391161        2463,     252,     0, 129;
%e A391161   168710720, 2360896, 98560,   0, 43968;
%e A391161   ...
%o A391161 (PARI)
%o A391161 permcount(v) = {my(m=1, s=0, k=0, t); for(i=1, #v, t=v[i]; k=if(i>1&&t==v[i-1], k+1, 1); m*=t*k; s+=t); s!/m}
%o A391161 C(d, r)={sum(i=1, #r, my(t=r[i]); if(d%t==0, t))}
%o A391161 D(u,v,r) = {prod(i=1, #u, prod(j=1, #v, my(g=gcd(u[i], v[j]));  C(u[i]*v[j]/g, r)^g))}
%o A391161 E(v,r) = {prod(i=2, #v, prod(j=1, i-1, my(g=gcd(v[i], v[j])); C(v[i]*v[j]/g, r)^g)) * prod(i=1, #v, my(t=v[i]); C(t,r)^((t+1)\2)*if(t%2, 1, C(t/2,r)))}
%o A391161 L2(n,pz) = { sum(k=0, n, my(s=0); forpart(p=k, forpart(q=n-k, my(r=concat([pz,p,q])); s += (-1)^#p * permcount(p) * permcount(q) * D(pz,p,r) * D(q,r,r) * E(p,r))); s/(k!*(n-k)!)) }
%o A391161 T(n,k) = { my(s=0); forpart(p=k, s+=permcount(p) * E(p,p) * L2(n-k,p)); s/k! }
%Y A391161 Row sums are A391162.
%Y A391161 Main diagonal is A001425.
%Y A391161 Column k=0 is A391156.
%Y A391161 Cf. A001329, A386681 (labeled version), A391155.
%K A391161 nonn,tabl
%O A391161 0,4
%A A391161 _Andrew Howroyd_, Dec 11 2025
