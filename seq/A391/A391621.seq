%I A391621 #10 Jan 04 2026 23:27:50
%S A391621 2,3,2,4,2,2,2,5,2,3,2,2,1,2,2,6,2,3,2,3,2,2,2,2,0,2,1,2,1,2,2,7,2,3,
%T A391621 2,4,2,2,2,3,1,3,2,2,1,2,2,2,0,1,0,2,2,1,1,2,0,2,1,2,1,2,2,8,2,3,2,4,
%U A391621 2,2,2,4,2,3,2,2,1,2,2,3,0,2,1,3,2,2,2
%N A391621 Number of nonnegative integer sequences whose first sums are the k-th composition in standard order.
%C A391621 The first sums of a nonempty sequence (a, b, c, d, ...) are (a+b, b+c, c+d, ...).
%C A391621 The k-th composition in standard order (graded reverse-lexicographic, A066099) is obtained by taking the set of positions of 1's in the reversed binary expansion of k, prepending 0, taking first differences, and reversing again. This gives a bijective correspondence between nonnegative integers and integer compositions.
%C A391621 Also the number of integers b such that the b-based partial alternating sums of the k-th composition in standard order are nonnegative. Here, the b-based partial alternating sums of a sequence q are given by pas(q,b)_j = (-1)^j * b + Sum_{i=1..j} (-1)^(i+j) * q_i.
%e A391621 The 18-th composition in standard order is (3,2), and we have the following nonnegative integer sequences with first sums (3,2):
%e A391621   (1,2,0)
%e A391621   (2,1,1)
%e A391621   (3,0,2)
%e A391621 so a(18) = 3.
%e A391621 For n = 68 we have nonnegative sequences: (1,3,0), (2,2,1), (3,1,2), (4,0,3), so a(68) = 4.
%e A391621 For n = 150, all sequences with first sums (3,2,1,2) are of the form (b,3-b,-1+b,2-b,b) for some b. This is nonnegative for b = 1 or b = 2, so a(150) = 2.
%t A391621 stc[n_]:=Differences[Prepend[Join @@ Position[Reverse[IntegerDigits[n,2]],1],0]]//Reverse;
%t A391621 pas[y_, k_]:=Table[(-1)^j*k+Sum[(-1)^(i-j)*y[[i]], {i, j}], {j, 0, Length[y]}];
%t A391621 Table[Length[Select[Table[pas[stc[n],b],{b,0,Max[stc[n]]}], Min@@#>=0&]],{n,100}]
%Y A391621 For prime indices instead of standard compositions we have A055396 + 1.
%Y A391621 Positions of 0 are A390747 (count A391645), for compositions A390677.
%Y A391621 Positions of 1 are A391622 (count A391643), for compositions A390745 (count A391644).
%Y A391621 Positions of terms > 1 are A391623.
%Y A391621 For positive instead of nonnegative sequences we have A391642.
%Y A391621 A011782 counts compositions.
%Y A391621 A066099 lists all compositions in standard order.
%Y A391621 A357213 counts compositions by sum of first sums.
%Y A391621 A390432 lists first sums of standard compositions.
%Y A391621 A390673 ranks compositions with distinct first sums, counted by A390567.
%Y A391621 A390674 ranks compositions with equal first sums, counted by A342527.
%Y A391621 Cf. A000120, A001511, A029837, A029931, A070939, A390449, A390568, A390675, A390676, A390678.
%K A391621 nonn,new
%O A391621 1,1
%A A391621 _Gus Wiseman_, Dec 19 2025
