%I A391438 #13 Dec 10 2025 10:36:04
%S A391438 1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,2,
%T A391438 1,1,1,1,2,1,1,2,2,1,1,1,1,1,1,2,1,1,1,1,1,1,2,1,2,1,2,1,1,1,1,2,1,2,
%U A391438 1,1,2,2,1,1,1,1,1,1,1,2,1,1,2,1,1,2,1,2,2,1,1,1,1,1,1,2,2,2,1,1,2,1,1,1,2,1,1,1,1,1,2,1,1,2,1,2,2,1,1,1,2,1,1,2,1,1,2,2,1,1,2,1,2,1,1,2,1,1,2,1,1,1,2,1,2,2,1,1,1,2,1,2,1,1,2,2,1,2,1,1,2,2,2,2,1,1,1,1,1,2,2,1,2,2,1,1,1,1,2,1,1,1,1,2,1,1,1,2,1,2,1,2,2,1,2,1,1,1,1,2,2,2,2,1,1,1,2,1,2,1,1,2,1,1,1,1,2,1,4
%N A391438 Number of elements that square to the identity in the class group of the order of real quadratic fields with discriminant A079896(n).
%C A391438 Number of elements that square to the identity in the form class group of discriminant D = A079896(n) quotient by {I,-I}, where I is the principal class. (So I corresponds to the form x^2 - (D/4)*y^2 for 4|D and x^2 - x*y - ((D-1)/4)*y^2 for D == 1 (mod 4), and -I corresponds to the form (D/4)*x^2 - y^2 for 4|D and ((D-1)/4)*x^2 - x*y - y^2 for D == 1 (mod 4)).
%H A391438 Jianing Song, <a href="/A391438/b391438.txt">Table of n, a(n) for n = 1..10000</a>
%H A391438 Rick L. Shepherd, <a href="http://libres.uncg.edu/ir/uncg/f/Shepherd_uncg_0154M_11099.pdf">Binary quadratic forms and genus theory</a>, Master of Arts Thesis, University of North Carolina at Greensboro, 2013.
%F A391438 For D = A079896(n), we have a(n) = 2^(A391441(n) - 1) if 16|D or D has a prime factor congruent to 3 modulo 4, and a(n) = A391441(n) otherwise. (Note that A391441(n) = omega(|D|) - t, where omega = A001221, and t = 0 if 32|D, t = 2 if D == 4 (mod 16), t = 1 otherwise; see A391441 for more details).
%o A391438 (PARI) r(D) = omega(D) - if(D%32==0, 0, if(D%16==4, 2, 1)) \\ gives 2-rank of Cl+(D)
%o A391438 s(D) = if(D%16==0, return(r(D)-1)); my(f = factor(D)[,1]~); for(i=1, #f, if(f[i]%4==3, return(r(D)-1))); return(r(D)) \\ gives 2-rank of Cl(D)
%o A391438 for(D=1, 1000, if(D%4<=1 && !issquare(D), print1(2^s(D), ", ")))
%Y A391438 Cf. A003640 (for imaginary quadratic fields).
%Y A391438 Sequences related to the class groups of real quadratic fields:
%Y A391438              |          Class groups         |       Form class groups       |
%Y A391438 -------------+-------------------------------+-------------------------------+
%Y A391438  Fundamental | 2-rank: A391436, A391437      | 2-rank: A317991, A317992      |
%Y A391438  disc. only  | # of genera: A391426, A391435 | # of genera: A317989, A317990 |
%Y A391438   (A003658)  | Exponent <= 2: A391417        | Exponent <= 2: A391422        |
%Y A391438 -------------+-------------------------------+-------------------------------+
%Y A391438   All disc.  | 2-rank: A391439               | 2-rank: A391441               |
%Y A391438   (A079896)  | # of genera: this seq.        | # of genera: A391440          |
%Y A391438              | Exponent <= 2: A391419        | exponent <= 2: A390079        |
%Y A391438 For a list of sequences related to the class numbers of real quadratic fields, see A087048.
%K A391438 nonn,changed
%O A391438 1,14
%A A391438 _Jianing Song_, Dec 09 2025
