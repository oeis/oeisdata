%I A391787 #30 Dec 31 2025 09:47:14
%S A391787 0,2,4,9,19,35,70,139,278,558,1070,2140,4253,8503,17006,34007,68014,
%T A391787 136028,272060,534204,1068408,2133369,4266362,8532669,17065338,
%U A391787 34130555,68261103,136522206,273044399,546088798,1092177596,2184355183,4368710366,8737420732,17474841464
%N A391787 a(n) is the least n-bit number k such that k has the maximum number of distinct (nonempty) substrings in the binary representation of k.
%C A391787 The number of substrings in k is A141297(k) and the maximum possible in n bits is A094913(n), so that a(n) is the smallest k for which A141297(k) = A094913(n).
%C A391787 a(n) is an n bit number since the maximum A094913(n) is strictly increasing.
%C A391787 When computing a(n), one may speed the calculations considerably by "stopping early" when the maximum value seen equals A094913(n) = A006697(n)-1; see Allouche and Shallit, p. 6. - _Michael S. Branicky_, Dec 31 2025
%H A391787 J.-P. Allouche and Jeffrey Shallit, <a href="https://arxiv.org/abs/1605.02361">On the subword complexity of the fixed point of a -> aab, b -> b, and generalizations</a>, arXiv preprint arXiv:1605.02361 [math.CO], 2016.
%e A391787 For n = 4: the least 4-bit number which has the maximum number of distinct (nonempty) substrings in the binary representation is k = (9)_10 = (1001)_2 with 8 substrings {0,1,00,01,10,001,100,1001}, thus a(4) = 9.
%t A391787 a[n_] := Module[{k1 = If[n == 1, 0, 2^(n-1)], k2 = 2^n-1, kmax, f, fmax = -1}, Do[f = -1 + CountDistinct[Subsequences[IntegerDigits[k, 2]]]; If[f > fmax, fmax = f; kmax = k], {k, k1, k2}]; kmax]; Array[a, 15] (* _Amiram Eldar_, Dec 21 2025 *)
%o A391787 (Python)
%o A391787 from itertools import product
%o A391787 def f(w): # A141297 for binary string w
%o A391787     m = len(w)
%o A391787     return len(set(w[i:j] for i in range(m) for j in range(i+1, m+1)))
%o A391787 def a(n):
%o A391787     if n == 1: return 0
%o A391787     mx, agmx = -1, None
%o A391787     for w in product("01", repeat=n-1):
%o A391787         w = "1" + "".join(w)
%o A391787         v = f(w)
%o A391787         if v > mx:
%o A391787             mx, argmx = v, int(w, 2)
%o A391787             # CAN STOP EARLY HERE: if mx == A006697(n) - 1: return argmx
%o A391787     return argmx
%o A391787 print([a(n) for n in range(1, 17)]) # _Michael S. Branicky_, Dec 31 2025
%Y A391787 Cf. A094913, A141297.
%K A391787 nonn,base
%O A391787 1,2
%A A391787 _Ctibor O. Zizka_, Dec 20 2025
%E A391787 a(25)-a(35) from _Michael S. Branicky_, Dec 31 2025
