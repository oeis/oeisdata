%I A391786 #62 Feb 11 2026 11:33:10
%S A391786 1,1,1,1,2,3,1,2,6,7,1,3,9,19,23,1,3,12,28,66,71,1,4,16,44,110,236,
%T A391786 252,1,4,20,60,170,396,868,890,1,5,25,85,255,651,1519,3235,3299,1,5,
%U A391786 30,110,365,1001,2520,5720,12190,12283,1,6,36,146,511,1512,4032,9752,21942,46252,46508
%N A391786 Triangle read by rows: T(n, k) = number of reversible strings with n black beads and k white beads, 0 <= k <= n.
%H A391786 Paolo Xausa, <a href="/A391786/b391786.txt">Table of n, a(n) for n = 0..11475</a> (rows 0..150 of triangle, flattened).
%F A391786 For k < n, T(n, k) = (binomial(n+k, n) + S1(n, k)) / 2 where S1(n, k) is 0 if both n and k are odd, and S1(n, k) = binomial(floor((n+k)/2), floor(k/2)) otherwise.
%F A391786 T(n, n) = A045723(n) = (binomial(2*n, n)/2 + A027306(n)) / 2.
%F A391786 (S1(n, k) and A027306(n) are the number of symmetrical (achiral) strings.)
%e A391786 Triangle T(n, k) begins:
%e A391786   1;
%e A391786   1, 1;
%e A391786   1, 2,  3;
%e A391786   1, 2,  6,  7;
%e A391786   1, 3,  9, 19, 23;
%e A391786   1, 3, 12, 28, 66, 71;
%e A391786   ...
%e A391786 T(4, 0) = 1: nnnn.
%e A391786 T(4, 1) = 3: nnnnk, nnnkn, nnknn.
%e A391786 T(4, 2) = 9: nnnnkk, nnnknk, nnnkkn, nnknnk, nnknkn, nknnnk, nnkknn, nknnkn, knnnnk.
%e A391786 T(4, 3) = 19: nnnnkkk, knnnnkk, nnnknkk, nnnkknk, nnnkkkn, knnnknk, knnnkkn, kknnnkn, nnknnkk, nnkknnk, nnknknk, nnknkkn, nnkknkn, knnknkn, nknnknk, nknnkkn, nnkkknn, knnknnk, nknknkn.
%e A391786 T(4, 4) = 23: nnnkkkkn, nnnkkknk, nnnkknkk, nnkkknnk, nnknkkkn, nnkkknkn, nknnkkkn, nnknkknk, nnkknknk, nkknnknk, nnkknkkn, nkknknkn, nnnnkkkk, nnkkkknn, nnnknkkk, nkkknnnk, nnkknnkk, nnknknkk, nknnkknk, nkknknnk, nknknknk, nkknnkkn, nknkknkn.
%t A391786 A391786[n_, k_] := If[n == k, (2^n + Binomial[2*n, n] + 2*Binomial[n-1, (n-2)/2]*Mod[n+1, 2])/4, (Binomial[n+k, n] + If[AllTrue[{n, k}, OddQ], 0, Binomial[Quotient[n+k, 2], Quotient[k, 2]]])/2];
%t A391786 Table[A391786[n, k], {n, 0, 10}, {k, 0, n}] (* _Paolo Xausa_, Feb 11 2026 *)
%o A391786 (PARI) A391786(n, k)={if(k<n, (binomial(n+k, n) + if(n%2==0 || k%2==0, binomial((n+k)\2, k\2)))/2, A045723(n))} \\ _M. F. Hasler_, Feb 09 2026
%o A391786 /* then, e.g.: concat( [[A391786(n, k)|k<-[0..n]]|n<-[0..10]] ) */
%Y A391786 Antidiagonal sums give A005418.
%Y A391786 Main diagonal is A045723.
%Y A391786 2nd diagonal is A005654.
%Y A391786 Cf. A027306.
%K A391786 nonn,tabl,new
%O A391786 0,5
%A A391786 _Stephen G Taylor_, Dec 20 2025
